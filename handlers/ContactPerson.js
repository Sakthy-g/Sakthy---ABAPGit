/*
 * Copyright (C) 2009-2018 SAP SE or an SAP affiliate company. All rights reserved.
 */
jQuery.sap.declare("fcg.mdg.editbp.handlers.ContactPerson");jQuery.sap.require("fcg.mdg.editbp.handlers.ContactPersonCreate");jQuery.sap.require("fcg.mdg.editbp.handlers.ContactPersonChange");fcg.mdg.editbp.handlers.ContactPerson={oController:"",oResult:"",oRelResults:"",oBPAddrResults:"",oCPResults:"",vReEditIndex:"",oReEditModel:"",oContactPersonLayout:"",oWorkPlaceLayout:"",aCPQueryModel:[],oCPModel:"",oDispCPModel:"",vCPCreated:0,vCustomerID:"",oWpFormId:0,oWpNewForm:"",aWpNewForm:[],vIdCounterTel:0,aAllCounters:[],vNewTelField:"",vIdCounterFax:0,vNewFaxField:"",vIdCounterMob:0,vNewMobField:"",vIdCounterEmail:0,vNewEmailField:"",wpArray:[],oIavFormId:0,oIavNewForm:"",selectedAddVersion:[],oEditIAVModel:"",oWpAddressResults:{},oWpIavResults:{},oDialogCP:"",lnameFlag:"",fnameFlag:"",cpDesc:"",oPartnerModel:"",aInitilCP:[],vgIsLocked:"",standardAddress:"",vBPguid2:"",clearGlobalVariables:function(c){if(this.oContactPersonLayout!==undefined&&this.oContactPersonLayout!==""){try{this.oContactPersonLayout.destroy();}catch(e){}}if(this.oWorkPlaceLayout!==undefined&&this.oWorkPlaceLayout!==""){try{this.oWorkPlaceLayout.destroy();}catch(e){}}if(c.getView().byId("editLayout").getContent().length>0){for(var a=0;a<c.getView().byId("editLayout").getContent().length;a++){try{c.getView().byId("editLayout").getContent()[a].destroy();}catch(e){}}}this.oContactPersonLayout="";this.oWorkPlaceLayout="";this.oController="";this.oResult="";this.oRelResults="";this.oBPAddrResults="";this.oCPResults="";this.vReEditIndex="";this.oReEditModel="";this.aCPQueryModel=[];this.oCPModel="";this.oDispCPModel="";this.vCPCreate=0;this.vCustomerID="";this.oWpFormId=0;this.aWpFormId=[];this.oWpNewForm="";this.vIdCounterTel=0;this.vNewTelField="";this.vIdCounterFax=0;this.vNewFaxField="";this.vIdCounterMob=0;this.vNewMobField="";this.vIdCounterEmail=0;this.vNewEmailField="";this.wpArray=[];this.oIavFormId=0;this.oIavNewForm="";this.selectedAddVersion=[];this.oEditIAVModel="";this.oWpAddressResults={};this.oWpIavResults={};this.lnameFlag="";this.fnameFlag="";this.cpDesc="";this.oPartnerModel="";this.aAllCounters=[];this.vgIsLocked="";this.standardAddress="";this.vBPguid2="";fcg.mdg.editbp.handlers.ContactPersonCreate.countryError=false;fcg.mdg.editbp.handlers.ContactPersonCreate.vIavIndex="";fcg.mdg.editbp.handlers.ContactPersonChange.oController="";fcg.mdg.editbp.handlers.ContactPersonChange.oCPDeleteQueryModel=[];fcg.mdg.editbp.handlers.ContactPersonChange.oCPDeleteModel=[];fcg.mdg.editbp.handlers.ContactPersonChange.oWPModel="";fcg.mdg.editbp.handlers.ContactPersonChange.numPhone="";fcg.mdg.editbp.handlers.ContactPersonChange.oWPResults=[];fcg.mdg.editbp.handlers.ContactPersonChange.ocpRslts=[];fcg.mdg.editbp.handlers.ContactPersonChange.ocpChangeModel="";fcg.mdg.editbp.handlers.ContactPersonChange.oCPData="";fcg.mdg.editbp.handlers.ContactPersonChange.aChangedCP=[];fcg.mdg.editbp.handlers.ContactPersonChange.cpQueryModel=[];fcg.mdg.editbp.handlers.ContactPersonChange.ocpAddressRslts=[];fcg.mdg.editbp.handlers.ContactPersonCreate.countryError=false;fcg.mdg.editbp.handlers.ContactPersonCreate.oWPIavModel="";fcg.mdg.editbp.handlers.ContactPersonCreate.oExistingIav="";fcg.mdg.editbp.handlers.ContactPersonCreate.vIsWPASelected="";fcg.mdg.editbp.handlers.ContactPersonCreate.aWpIds=[];},getContactPersonData:function(w){for(var l=0;l<this.aWpNewForm.length;l++){try{if(this.aWpNewForm[l]!==undefined&&this.aWpNewForm[l]!==""){this.aWpNewForm[l].destroy();}}catch(e){}}if(this.oWpNewForm!==undefined&&this.oWpNewForm!==""){try{this.oWpNewForm.destroy();}catch(e){}}this.oController=w;if(this.isNull(this.oRelResults)){var p="/BP_RootCollection(BP_GUID="+this.oController.sItemPath+")?$expand=";var r=p+"BP_RelationsRel";this.getRelationShipData();this.getAddressData();var a=fcg.mdg.editbp.util.DataAccess.readData(r,w);var R=[];for(var i=0;i<a.BP_RelationsRel.results.length;i++){if(a.BP_RelationsRel.results[i].RELATIONSHIPCATEGORY==="BUR001"){R.push(a.BP_RelationsRel.results[i]);this.aInitilCP.push(a.BP_RelationsRel.results[i].PARTNER2);}}a.BP_RelationsRel.results=[];a.BP_RelationsRel.results=R;this.setRelResults(a);var E=this.oController.bpHookModifygetContactPersonData(r,w);if(E!==undefined){a=E;}}else{this.setWPAddressArray(this.oBPAddrResults);this.setWPIavArray(this.oBPAddrResults);}this.setActionLayout(this.oRelResults);},getRelationShipData:function(){var g=this;var p="/BP_RootCollection(BP_GUID="+this.oController.sItemPath+")?$expand=";var q=p+"BP_RelationsRel,BP_RelationsRel/BP_RelationContactPersonRel,BP_RelationsRel/BP_RelationContactPersonRel/BP_ContactPersonWorkplacesRel,BP_RelationsRel/BP_RelationContactPersonRel/BP_ContactPersonWorkplacesRel/BP_WorkplaceCommEMailsRel,BP_RelationsRel/BP_RelationContactPersonRel/BP_ContactPersonWorkplacesRel/BP_WorkplaceCommPhonesRel,BP_RelationsRel/BP_RelationContactPersonRel/BP_ContactPersonWorkplacesRel/BP_WorkplaceCommMobilesRel,BP_RelationsRel/BP_RelationContactPersonRel/BP_ContactPersonWorkplacesRel/BP_WorkplaceCommFaxesRel,BP_RelationsRel/BP_RelationContactPersonRel/BP_ContactPersonWorkplacesRel/BP_WorkplaceIntAddressVersRel,BP_RelationsRel/BP_RelationContactPersonRel/BP_ContactPersonWorkplacesRel/BP_WorkplaceIntAddressVersRel/BP_WorkplaceIntPersVersionRel";var d=new sap.ui.model.odata.ODataModel(this.oController.getView().getModel().sServiceUrl,true);var e=this.oController.bpHookModifyRelQueryCall(q,this);if(e!==undefined){q=e;}d.read(q,null,null,true,function(r){var R=[];for(var i=0;i<r.BP_RelationsRel.results.length;i++){if(r.BP_RelationsRel.results[i].RELATIONSHIPCATEGORY==="BUR001"){R.push(r.BP_RelationsRel.results[i]);}}r.BP_RelationsRel.results=[];r.BP_RelationsRel.results=R;g.oRelResults=r;});},getAddressData:function(){var g=this;var p="/BP_RootCollection(BP_GUID="+this.oController.sItemPath+")?$expand=";var a=p+"BP_AddressesRel/BP_AddressVersionsOrgRel";var d=new sap.ui.model.odata.ODataModel(this.oController.getView().getModel().sServiceUrl,true);d.read(a,null,null,true,function(r){g.oBPAddrResults=r;g.setWPAddressArray(r);g.setWPIavArray(r);var e=g.oController.bpHookModifygetAddressData(a,g);if(e!==undefined){g.oBPAddrResults=e;}});},setActionLayout:function(r){this.oController.getView().byId("entityStep").setNextStep(this.oController.getView().byId("actionStep"));if(this.oController.oActionLayout===""){this.oController.oActionLayout=sap.ui.xmlfragment("fcg.mdg.editbp.frag.generic.SelectAction",this.oController);}this.oController.getView().byId("actionLayout").setVisible(true);this.oController.getView().byId("actionLayout").addContent(this.oController.oActionLayout);sap.ui.getCore().byId("changeRB").setVisible(true);this.oController.setRadioButtonText();if(r.BP_RelationsRel.results.length===0){sap.ui.getCore().byId("changeRB").setEnabled(false);sap.ui.getCore().byId("actionRBG").setSelectedIndex(-1);sap.ui.getCore().byId("deleteRB").setEnabled(false);}else{sap.ui.getCore().byId("changeRB").setEnabled(true);sap.ui.getCore().byId("actionRBG").setSelectedIndex(1);sap.ui.getCore().byId("deleteRB").setEnabled(true);}this.oController.setActionView("actionStep","select_action");},handleContactPerson:function(w){this.vReEditIndex="";this.oController=w;var c=this.getRelResults();if(this.oBPAddrResults!==""){this.setWPAddressArray(fcg.mdg.editbp.handlers.ContactPerson.oBPAddrResults);this.setWPIavArray(fcg.mdg.editbp.handlers.ContactPerson.oBPAddrResults);}if(w.vCurrentActionId==="createRB"){this.createContactPerson();}else if(w.vCurrentActionId==="changeRB"||w.vCurrentActionId==="deleteRB"){fcg.mdg.editbp.handlers.ContactPersonChange.editContactPerson(c,w);}},handleSelectItemForCP:function(w){this.oController=w;if(this.oBPAddrResults!==""){this.setWPAddressArray(fcg.mdg.editbp.handlers.ContactPerson.oBPAddrResults);this.setWPIavArray(fcg.mdg.editbp.handlers.ContactPerson.oBPAddrResults);}if(this.oController.vCurrentActionId==="changeRB"){var l=this.oController.vCurrentSelectdDataId.length;var i=this.oController.vCurrentSelectdDataId.substring(l-1,l);fcg.mdg.editbp.handlers.ContactPersonChange.editContactPersonPage(i,w);}},createContactPerson:function(){this.oController.getView().byId("actionStep").setNextStep(this.oController.getView().byId("editStep"));if(this.oController.getView().byId("editLayout").getContent().length>0){for(var c=0;c<this.oController.getView().byId("editLayout").getContent().length;c++){this.oController.getView().byId("editLayout").getContent()[c].destroy();c--;}}if(this.oContactPersonLayout===""){this.oContactPersonLayout=sap.ui.xmlfragment("fcg.mdg.editbp.frag.bp.EditContactPerson",this);}else{this.oContactPersonLayout.destroy();this.oContactPersonLayout=sap.ui.xmlfragment("fcg.mdg.editbp.frag.bp.EditContactPerson",this);}var e=this.oController.bpHookModifyCreateContactPerson(this);if(e!==undefined){this.oContactPersonLayout=e;}this.oController.getView().byId("editLayout").setVisible(true);this.oController.getView().byId("editLayout").removeAllContent();this.oController.getFileUploadData("editLayout");this.oController.getView().byId("editLayout").addContent(this.oContactPersonLayout);this.getValueHelp();if(this.oController.isAddressVisited==="X"){if(this.oController.oDetailComm.BP_AddressesRel.results.length>0||fcg.mdg.editbp.handlers.Communication.oCreateModel.length>0){this.loadWPToolBar();}}else if(this.oBPAddrResults.BP_AddressesRel.results.length>0){this.loadWPToolBar();}},loadWPToolBar:function(){if(this.oWorkPlaceLayout===""){this.oWorkPlaceLayout=sap.ui.xmlfragment("fcg.mdg.editbp.frag.bp.EditWPAddress",this);}else{try{this.oWorkPlaceLayout.destroy();}catch(e){}this.oWorkPlaceLayout=sap.ui.xmlfragment("fcg.mdg.editbp.frag.bp.EditWPAddress",this);}var E=this.oController.bpHookModifyLoadWPToolBar(this);if(E!==undefined){this.oWorkPlaceLayout=E;}this.oController.getView().byId("editLayout").addContent(this.oWorkPlaceLayout);sap.ui.getCore().byId("toolWPAdd").attachPress(fcg.mdg.editbp.handlers.ContactPersonCreate.addWPAddress);},getCurrentDispCpForm:function(w,a){if(w.reEdit!=="X"){var c=a.getContent();var g=c[c.length-1];return g;}else{return a.getContent()[this.vReEditIndex];}},destroyAddressTittle:function(m,c,w){var d=false;var p=m.BP_RelationPartnerRel.BP_PersonRel;if(m.PARTNER2!==undefined&&m.PARTNER2!==""){d=true;}if(m.BP_RelationPartnerRel.TITLE_KEY!==undefined&&m.BP_RelationPartnerRel.TITLE_KEY!==""){d=true;}if(!this.isNull(p)){if((p.FIRSTNAME!==undefined&&p.FIRSTNAME!=="")||(p.LASTNAME!==undefined&&p.LASTNAME!=="")||(p.TITLE_ACA1!==undefined&&p.TITLE_ACA1!=="")||(p.SEX!==undefined&&p.SEX!=="")||(p.CORRESPONDLANGUAGE!==undefined&&p.CORRESPONDLANGUAGE!=="")){d=true;}}if(d===false){var l=c.getContent().length-1;var a=c.getContent()[l].getContent();for(var i=0;i<a.length-2;i++){a[i].destroy();}}},displayCpIAV:function(m,c,w){var d;var l=w;var a;var I="";var n="";var f=0;var g;if(w.vCurrentActionId==="changeRB"){g=c;}else{g=fcg.mdg.editbp.handlers.ContactPerson.getCurrentDispCpForm(w,c);}if(!this.isNull(m)&&m.length>0){for(var i=0;i<m.length;i++){var b=undefined;if(m[i].action!=="D"){if(w.vCurrentActionId==="createRB"){b=m[i].BP_WorkplaceIntAddressVersRel;}else if(w.vCurrentActionId==="deleteRB"){b=m[i].BP_WorkplaceIntAddressVersRel.results;}else if(w.vCurrentActionId==="changeRB"){if(m[i].BP_WorkplaceIntAddressVersRel!==undefined){b=m[i].BP_WorkplaceIntAddressVersRel.results;}}if(!this.isNull(b)&&b.length>0){var e;for(var j=0;j<b.length;j++){if(b[j].action!=="D"){if(n===""||n===undefined){var t=g.getContent().length-1;n=g.getContent()[t];f=g.getContent().indexOf(n);}else{f=g.getContent().indexOf(n);}f=f+1;if(i!==0){a=new sap.m.Label({text:""});g.insertContent(a,f);n=a;f=g.getContent().indexOf(n);f=f+1;if(I==="X"){e=new sap.ui.core.Title({text:w.i18nBundle.getText("IAV")});g.insertContent(e,f);I="";}else{e=new sap.m.Title({text:w.i18nBundle.getText("IAV")});g.insertContent(e,f);}n=e;}if(i===0&&j>0){a=new sap.m.Label({text:""});g.insertContent(a,f);n=a;if(I==="X"){e=new sap.ui.core.Title({text:w.i18nBundle.getText("IAV")});g.insertContent(e,f);I="";}else{a=new sap.m.Label({text:""});g.insertContent(a,f);n=a;f=f+1;e=new sap.m.Title({text:w.i18nBundle.getText("IAV")});g.insertContent(e,f);}n=e;}if(i===0&&j===0){if(I==="X"){e=new sap.ui.core.Title({text:w.i18nBundle.getText("IAV")});g.insertContent(e,f);I="";n=e;}else{if(j!==0){e=new sap.m.Title({text:w.i18nBundle.getText("IAV")});g.insertContent(e,f);n=e;}}}f=g.getContent().indexOf(n);f=f+1;var h=new sap.m.Label({text:w.i18nBundle.getText("WP_ADD")});g.insertContent(h,f);n=h;f=g.getContent().indexOf(n);f=f+1;var k=new sap.m.Text({text:{path:m[i].ADDRESS_NUMBER__TXT,formatter:function(){if(l.vCurrentActionId==="changeRB"){var V=m[i].ADDRESS_NUMBER__TXT;var C=m[i].ChangeData.ADDRESS_NUMBER__TXT;return fcg.mdg.editbp.util.Formatter.boldCPChanges(V,C,this);}else{return m[i].ADDRESS_NUMBER__TXT;}}}});g.insertContent(k,f);n=k;f=g.getContent().indexOf(n);f=f+1;var o=new sap.m.Label({text:w.i18nBundle.getText("ADDRESSVERSION")});g.insertContent(o,f);n=o;f=g.getContent().indexOf(n);f=f+1;var p;if(l.vCurrentActionId==="changeRB"){p=new sap.m.Text({text:{path:b[j].ADDR_VERS__TXT,formatter:function(){if(l.vCurrentActionId==="changeRB"){var V=b[j].ADDR_VERS__TXT;var C=b[j].ChangeData.ADDR_VERS__TXT;return fcg.mdg.editbp.util.Formatter.boldCPChanges(V,C,this);}else{return b[j].ADDR_VERS__TXT;}}},layoutData:new sap.ui.layout.GridData({span:"L12 M12 S12",linebreakL:true,linebreakM:true,linebreakS:true})});}else{p=new sap.m.Text({text:b[j].BP_WorkplaceIntPersVersionRel.ADDR_VERS__TXT,layoutData:new sap.ui.layout.GridData({span:"L12 M12 S12",linebreakL:true,linebreakM:true,linebreakS:true})});}g.insertContent(p,f);n=p;if(!this.isNull(b[j].BP_WorkplaceIntPersVersionRel.TITLE_P)){if(b[j].BP_WorkplaceIntPersVersionRel.TITLE_P!==""){f=g.getContent().indexOf(n);f=f+1;var q=new sap.m.Label({text:w.i18nBundle.getText("TITLE")});g.insertContent(q,f);n=q;f=g.getContent().indexOf(n);f=f+1;var r=new sap.m.Text({text:{path:b[j].BP_WorkplaceIntPersVersionRel.TITLE_P__TXT,formatter:function(){if(l.vCurrentActionId==="changeRB"){var V=b[j].BP_WorkplaceIntPersVersionRel.TITLE_P__TXT;var C=b[j].BP_WorkplaceIntPersVersionRel.ChangeData.TITLE_P__TXT;return fcg.mdg.editbp.util.Formatter.boldCPChanges(V,C,this);}else{return b[j].BP_WorkplaceIntPersVersionRel.TITLE_P__TXT;}}},layoutData:new sap.ui.layout.GridData({span:"L12 M12 S12",linebreakL:true,linebreakM:true,linebreakS:true})});g.insertContent(r,f);n=r;}}if(!this.isNull(b[j].BP_WorkplaceIntPersVersionRel.FIRSTNAME)){f=g.getContent().indexOf(n);f=f+1;var s=new sap.m.Label({text:w.i18nBundle.getText("F_Name")});g.insertContent(s,f);n=s;f=g.getContent().indexOf(n);f=f+1;var u=new sap.m.Text({text:{path:b[j].BP_WorkplaceIntPersVersionRel.FIRSTNAME,formatter:function(){if(l.vCurrentActionId==="changeRB"){var V=b[j].BP_WorkplaceIntPersVersionRel.FIRSTNAME;var C=b[j].BP_WorkplaceIntPersVersionRel.ChangeData.FIRSTNAME;return fcg.mdg.editbp.util.Formatter.boldCPChanges(V,C,this);}else{return b[j].BP_WorkplaceIntPersVersionRel.FIRSTNAME;}}},layoutData:new sap.ui.layout.GridData({span:"L12 M12 S12",linebreakL:true,linebreakM:true,linebreakS:true})});g.insertContent(u,f);n=u;}if(!this.isNull(b[j].BP_WorkplaceIntPersVersionRel.LASTNAME)){f=g.getContent().indexOf(n);f=f+1;var v=new sap.m.Label({text:w.i18nBundle.getText("LN")});g.insertContent(v,f);n=v;f=g.getContent().indexOf(n);f=f+1;var x=new sap.m.Text({text:{path:b[j].BP_WorkplaceIntPersVersionRel.LASTNAME,formatter:function(){if(l.vCurrentActionId==="changeRB"){var V=b[j].BP_WorkplaceIntPersVersionRel.LASTNAME;var C=b[j].BP_WorkplaceIntPersVersionRel.ChangeData.LASTNAME;return fcg.mdg.editbp.util.Formatter.boldCPChanges(V,C,this);}else{return b[j].BP_WorkplaceIntPersVersionRel.LASTNAME;}}},layoutData:new sap.ui.layout.GridData({span:"L12 M12 S12",linebreakL:true,linebreakM:true,linebreakS:true})});g.insertContent(x,f);n=x;}if(!this.isNull(b[j].DEPARTMENT)){f=g.getContent().indexOf(n);f=f+1;var y=new sap.m.Label({text:w.i18nBundle.getText("DEPARTMENT")});g.insertContent(y,f);n=y;f=g.getContent().indexOf(n);f=f+1;var z=new sap.m.Text({text:{path:b[j].DEPARTMENT,formatter:function(){if(l.vCurrentActionId==="changeRB"){var V=b[j].DEPARTMENT;var C=b[j].ChangeData.DEPARTMENT;return fcg.mdg.editbp.util.Formatter.boldCPChanges(V,C,this);}else{return b[j].DEPARTMENT;}}},layoutData:new sap.ui.layout.GridData({span:"L12 M12 S12",linebreakL:true,linebreakM:true,linebreakS:true})});g.insertContent(z,f);n=z;}if(!this.isNull(b[j].FUNCTION)){f=g.getContent().indexOf(n);f=f+1;var A=new sap.m.Label({text:w.i18nBundle.getText("FUNCTION")});g.insertContent(A,f);n=A;f=g.getContent().indexOf(n);f=f+1;var B=new sap.m.Text({text:{path:b[j].FUNCTION,formatter:function(){if(l.vCurrentActionId==="changeRB"){var V=b[j].FUNCTION;var C=b[j].ChangeData.FUNCTION;return fcg.mdg.editbp.util.Formatter.boldCPChanges(V,C,this);}else{return b[j].FUNCTION;}}},layoutData:new sap.ui.layout.GridData({span:"L12 M12 S12",linebreakL:true,linebreakM:true,linebreakS:true})});g.insertContent(B,f);n=B;}}else if(i===0&&j===0&&b[j].action==="D"){if(I===""){d=g.getContent().length-1;g.getContent()[d].destroy();I="X";}}}}else{if(I===""){d=g.getContent().length-1;g.getContent()[d].destroy();I="X";}}}else if(i===0&&m[i].action==="D"){if(I===""){d=g.getContent().length-1;g.getContent()[d].destroy();I="X";}}}}else{if(I===""){d=g.getContent().length-1;g.getContent()[d].destroy();I="X";}}},displayWPAddress:function(m,c,w){var g;var l=w;var n="";var f=0;if(w.vCurrentActionId==="changeRB"){g=c;}else{g=fcg.mdg.editbp.handlers.ContactPerson.getCurrentDispCpForm(w,c);}if(!this.isNull(m)&&m.length>0){for(var i=0;i<m.length;i++){var N="";if(m[i].action!=="D"){N="X";var a=new sap.ui.model.json.JSONModel();a.setData(m[i]);if(n===""||n===undefined){var t=g.getContent().length-2;n=g.getContent()[t];}else{f=g.getContent().indexOf(n);}f=f+1;if(i!==0&&m[i-1].action!=="D"){var b=new sap.m.Label({text:""});g.insertContent(b,f);n=b;f=g.getContent().indexOf(n);f=f+1;var d=new sap.m.Title({text:w.i18nBundle.getText("WP_ADD")});g.insertContent(d,f);n=d;}f=g.getContent().indexOf(n);f=f+1;var e=new sap.m.Label({text:w.i18nBundle.getText("Address")});g.insertContent(e,f);n=e;f=g.getContent().indexOf(n);f=f+1;var h=new sap.m.Text({text:{path:m[i].ADDRESS_NUMBER__TXT,formatter:function(){if(l.vCurrentActionId==="changeRB"){var V=m[i].ADDRESS_NUMBER__TXT;var H=m[i].ChangeData.ADDRESS_NUMBER__TXT;return fcg.mdg.editbp.util.Formatter.boldCPChanges(V,H,this);}else{return m[i].ADDRESS_NUMBER__TXT;}}}});g.insertContent(h,f);n=h;if(!this.isNull(m[i].DEPARTMENT)){f=g.getContent().indexOf(n);f=f+1;var k=new sap.m.Label({text:w.i18nBundle.getText("DEPARTMENT")});g.insertContent(k,f);n=k;f=g.getContent().indexOf(n);f=f+1;var o=new sap.m.Text({text:{path:m[i].DEPARTMENT,formatter:function(){if(l.vCurrentActionId==="changeRB"){var V=m[i].DEPARTMENT;var H=m[i].ChangeData.DEPARTMENT;return fcg.mdg.editbp.util.Formatter.boldCPChanges(V,H,this);}else{return m[i].DEPARTMENT;}}}});g.insertContent(o,f);n=o;}if(!this.isNull(m[i].FUNCTION)){f=g.getContent().indexOf(n);f=f+1;var p=new sap.m.Label({text:w.i18nBundle.getText("FUNCTION")});g.insertContent(p,f);n=p;f=g.getContent().indexOf(n);f=f+1;var q=new sap.m.Text({text:{path:m[i].FUNCTION,formatter:function(){if(l.vCurrentActionId==="changeRB"){var V=m[i].FUNCTION;var H=m[i].ChangeData.FUNCTION;return fcg.mdg.editbp.util.Formatter.boldCPChanges(V,H,this);}else{return m[i].FUNCTION;}}}});g.insertContent(q,f);n=q;}if(!this.isNull(m[i].BP_WorkplaceCommPhonesRel)){var r;f=g.getContent().indexOf(n);f=f+1;var s=new sap.m.Label({text:w.i18nBundle.getText("TEL")});g.insertContent(s,f);n=s;if(w.vCurrentActionId==="changeRB"||w.vCurrentActionId==="deleteRB"){r=m[i].BP_WorkplaceCommPhonesRel.results;}else{r=m[i].BP_WorkplaceCommPhonesRel;}for(var j=0;j<r.length;j++){if(r[j].action!=="D"&&(r[j].TELEPHONE!==""||r[j].EXTENSION!=="")&&(r[j].TELEPHONE!==undefined||r[j].EXTENSION!==undefined)){f=g.getContent().indexOf(n);f=f+1;var T=fcg.mdg.editbp.util.Formatter.extensionWithNumber(r[j].COUNTRY,r[j].TELEPHONE,r[j].EXTENSION);var u=new sap.m.Text({text:{path:T,formatter:function(){if(l.vCurrentActionId==="changeRB"){var V=T;if(r[j].ChangeData.COUNTRY!==undefined||r[j].ChangeData.TELEPHONE!==undefined||r[j].ChangeData.EXTENSION!==undefined){var H=V;}return fcg.mdg.editbp.util.Formatter.boldCPChanges(V,H,this);}else{return T;}}},layoutData:new sap.ui.layout.GridData({span:"L12 M12 S12",linebreakL:true,linebreakM:true,linebreakS:true})});g.insertContent(u,f);n=u;}}}if(!this.isNull(m[i].BP_WorkplaceCommMobilesRel)){var v;f=g.getContent().indexOf(n);f=f+1;var x=new sap.m.Label({text:w.i18nBundle.getText("MOB")});g.insertContent(x,f);n=x;if(w.vCurrentActionId==="changeRB"||w.vCurrentActionId==="deleteRB"){v=m[i].BP_WorkplaceCommMobilesRel.results;}else{v=m[i].BP_WorkplaceCommMobilesRel;}for(j=0;j<v.length;j++){if(v[j].action!=="D"&&v[j].TELEPHONE!==""&&v[j].TELEPHONE!==undefined){var M=fcg.mdg.editbp.util.Formatter.mobNumber(v[j].COUNTRY,v[j].TELEPHONE);f=g.getContent().indexOf(n);f=f+1;var y=new sap.m.Text({text:{path:M,formatter:function(){if(l.vCurrentActionId==="changeRB"){var V=M;if(v[j].ChangeData.COUNTRY!==undefined||v[j].ChangeData.TELEPHONE!==undefined){var H=V;}return fcg.mdg.editbp.util.Formatter.boldCPChanges(V,H,this);}else{return M;}}},layoutData:new sap.ui.layout.GridData({span:"L12 M12 S12",linebreakL:true,linebreakM:true,linebreakS:true})});g.insertContent(y,f);n=y;}}}if(!this.isNull(m[i].BP_WorkplaceCommFaxesRel)){var z;f=g.getContent().indexOf(n);f=f+1;var A=new sap.m.Label({text:w.i18nBundle.getText("FAX")});g.insertContent(A,f);n=A;if(w.vCurrentActionId==="changeRB"||w.vCurrentActionId==="deleteRB"){z=m[i].BP_WorkplaceCommFaxesRel.results;}else{z=m[i].BP_WorkplaceCommFaxesRel;}for(j=0;j<z.length;j++){if(z[j].action!=="D"&&(z[j].FAX!==""||z[j].EXTENSION!=="")&&(z[j].FAX!==undefined||z[j].EXTENSION!==undefined)){var F=fcg.mdg.editbp.util.Formatter.extensionWithNumber(z[j].COUNTRY,z[j].FAX,z[j].EXTENSION);f=g.getContent().indexOf(n);f=f+1;var B=new sap.m.Text({text:{path:F,formatter:function(){if(l.vCurrentActionId==="changeRB"){var V=F;if(z[j].ChangeData.COUNTRY!==undefined||z[j].ChangeData.FAX!==undefined||z[j].ChangeData.EXTENSION!==undefined){var H=V;}return fcg.mdg.editbp.util.Formatter.boldCPChanges(V,H,this);}else{return F;}}},layoutData:new sap.ui.layout.GridData({span:"L12 M12 S12",linebreakL:true,linebreakM:true,linebreakS:true})});g.insertContent(B,f);n=B;}}}if(!this.isNull(m[i].BP_WorkplaceCommEMailsRel)){var C;f=g.getContent().indexOf(n);f=f+1;var D=new sap.m.Label({text:w.i18nBundle.getText("E_MAIL")});g.insertContent(D,f);n=D;if(w.vCurrentActionId==="changeRB"||w.vCurrentActionId==="deleteRB"){C=m[i].BP_WorkplaceCommEMailsRel.results;}else{C=m[i].BP_WorkplaceCommEMailsRel;}for(j=0;j<C.length;j++){if(C[j].action!=="D"&&C[j].E_MAIL!==""&&C[j].E_MAIL!==undefined){f=g.getContent().indexOf(n);f=f+1;var E=new sap.m.Text({text:{path:C[j].E_MAIL,formatter:function(){if(l.vCurrentActionId==="changeRB"){var V=C[j].E_MAIL;var H=C[j].ChangeData.E_MAIL;return fcg.mdg.editbp.util.Formatter.boldCPChanges(V,H,this);}else{return C[j].E_MAIL;}}},layoutData:new sap.ui.layout.GridData({span:"L12 M12 S12",linebreakL:true,linebreakM:true,linebreakS:true})});g.insertContent(E,f);n=E;}}}f=g.getContent().indexOf(n);w.bpHookDisplayWPAddressCP(m,c,w,this,f,i);}}if(N!=="X"){var I=g.getContent()[g.getContent().length-1];var W=g.getContent()[g.getContent().length-2];I.destroy();W.destroy();}}else{var G=g.getContent().length-2;g.getContent()[G].destroy();}},getValueHelp:function(){var r=fcg.mdg.editbp.util.DataAccess.getValueHelpData();var d=this.oController.i18nBundle.getText("NONE");var g=new sap.ui.model.json.JSONModel();var a={results:[{KEY:"1",TEXT:this.oController.i18nBundle.getText("FEMALE"),ATTR_NAME:"SEX"},{KEY:"2",TEXT:this.oController.i18nBundle.getText("MALE"),ATTR_NAME:"SEX"},{KEY:"",TEXT:d,ATTR_NAME:"SEX"}]};g.setData(a);var b=new sap.ui.core.Item({key:"{KEY}",text:"{TEXT}"});var G=sap.ui.getCore().byId("SF-BP_Person-Gender");G.setModel(g);G.bindItems("/results",b);G.setSelectedKey();for(var i=0;i<r.length;i++){switch(i){case 0:var A=new sap.ui.model.json.JSONModel();A.setData(r[i].data);var c=new sap.ui.core.Item({key:"{KEY}",text:"{TEXT}"});var e=sap.ui.getCore().byId("SF-BP_Person-AcadTitle");e.setModel(A);e.bindItems("/results",c);var f=new sap.ui.core.Item({key:"",text:d});e.addItem(f);e.setSelectedKey();break;case 2:this.oController.aCorrLangValues=r[i].data;break;case 3:var t=new sap.ui.model.json.JSONModel();t.setData(r[i].data);var h=new sap.ui.core.Item({key:"{KEY}",text:"{TEXT}"});var T=sap.ui.getCore().byId("SF-BP_RelationPartner-title");T.setModel(t);T.bindItems("/results",h);var j=new sap.ui.core.Item({key:"",text:d});T.addItem(j);T.setSelectedKey();break;}}},createCPDataModel:function(w,p){this.oController=w;this.vCustomerID=p;if(w.vCurrentActionId==="createRB"){this.createModel();}else if(w.vCurrentActionId==="changeRB"){fcg.mdg.editbp.handlers.ContactPersonChange.changeModel(w);}else if(w.vCurrentActionId==="deleteRB"){fcg.mdg.editbp.handlers.ContactPersonChange.deleteModel(w);}},prepareCreatedArray:function(){var c=this.oController.createdArray;var o={};o.value="BUR001";o.entity="BP_Relation";o.field="RELATIONSHIPCATEGORY";c.push(o);var a={};var b=isNaN(parseInt(this.vCustomerID,10))?this.vCustomerID:this.pad(this.vCustomerID,10);a.value=b;a.entity="BP_Relation";a.field="PARTNER1";c.push(a);if(this.oController.vTimedependency==="X"){var d={};d.value=this.getCurrentDate();d.entity="BP_Relation";d.field="VALIDFROMDATE";c.push(d);var e={};e.value="9999-12-31T00:00:00";e.entity="BP_Relation";e.field="VALIDUNTILDATE";c.push(e);}var f={};f.value="1";f.entity="BP_RelationPartner";f.field="CATEGORY";c.push(f);return c;},createModel:function(){var c=this.prepareCreatedArray();var a=(JSON.parse(JSON.stringify(c)));var q={};var b="";var d="";var e="";var f="";var g=false;var p=false;var h=false;if(fcg.mdg.editbp.handlers.ContactPersonCreate.aWpIds.length>0){this.createAddressArr(a);}if(this.oController.reEdit===""){for(var i=0;i<a.length;i++){q.entity="BP_Relation";if(a[i].entity==="BP_Relation"){b=this.prepareEntityData(b,g,a[i]);g=true;}if(a[i].entity==="BP_RelationPartner"){f=this.prepareEntityData(f,p,a[i]);p=true;}if(a[i].entity==="BP_Person"){e=this.prepareEntityData(e,h,a[i]);h=true;}}b=b.substring(0,b.length-1)+"}";f=this.isNull(f)?"":f.substring(0,f.length-1)+"}";e=this.isNull(e)?"":e.substring(0,e.length-1)+"}";b=JSON.parse(b);d=JSON.parse(JSON.stringify(b));if(!this.isNull(f)){d.BP_RelationPartnerRel=JSON.parse(f);}if(!this.isNull(e)){d.BP_RelationPartnerRel.BP_PersonRel=JSON.parse(e);}if(!this.isNull(b.PARTNER2)){f="";e="";var P=isNaN(parseInt(b.PARTNER2,10))?b.PARTNER2:this.pad(b.PARTNER2,10);b.PARTNER2=P;}var j={};j.RELATIONSHIPCATEGORY=b.RELATIONSHIPCATEGORY;j.PARTNER1=b.PARTNER1;j.PARTNER2=b.PARTNER2;if(this.oController.vTimedependency==="X"){j.VALIDFROMDATE=b.VALIDFROMDATE;j.VALIDUNTILDATE=b.VALIDUNTILDATE;}if(this.wpArray.length>0){j.BP_ContactPersonWorkplacesRel=this.wpArray;}if(!this.isNull(f)){b.BP_RelationPartnerRel=JSON.parse(f);}if(!this.isNull(e)){b.BP_RelationPartnerRel.BP_PersonRel=JSON.parse(e);}b.BP_RelationContactPersonRel=j;q.body=b;q.cpdata=d;q.partner2=fcg.mdg.editbp.util.Formatter.removeLeadingZeroes(b.PARTNER2);q.index=this.vCPCreated;this.vCPCreated++;this.aCPQueryModel.push(q);this.oCPModel=q.body;this.oDispCPModel=q.cpdata;var E=this.oController.bpHookModifyCPCreateModel(this);if(E!==undefined){this.aCPQueryModel=E;}}else{for(var r=0;r<a.length;r++){this.aCPQueryModel[this.vReEditIndex].body[a[r].field]=a[r].value;}this.oReEditModel=new sap.ui.model.json.JSONModel();this.oReEditModel.setData(this.aCPQueryModel[this.vReEditIndex].body);}},createAddressArr:function(c){var w="";var W=[];var d=[],e=[];for(var k=0;k<c.length;k++){if(c[k].wpKey!==undefined){W.push(c[k]);}}W.sort(function(a,b){return parseInt(a.wpKey,10)-parseInt(b.wpKey,10);});for(var i=0;i<W.length;i++){var f={};if(W[i].entity==="BP_ContactPersonWorkplacesRel"&&W[i].wpKey!==undefined){if(w===W[i].wpKey){continue;}w=W[i].wpKey;for(var j=0;j<W.length;j++){if(W[j].entity==="BP_ContactPersonWorkplacesRel"&&W[i].wpKey===W[j].wpKey){if(W[j].key!==undefined){f[W[j].field]=W[j].key;f[W[j].field+"__TXT"]=W[j].value;}else{f[W[j].field]=W[j].value;}if(this.oController.vTimedependency==="X"){f.VALIDUNTILDATE="9999-12-31T00:00:00";}}}this.wpArray.push(f);}}if(fcg.mdg.editbp.handlers.ContactPerson.oController.isAddressVisited==="X"){e=fcg.mdg.editbp.handlers.ContactPerson.oController.oDetailComm.BP_AddressesRel.results;}else{e=fcg.mdg.editbp.handlers.ContactPerson.oBPAddrResults.BP_AddressesRel.results;}for(var l=0;l<e.length;l++){d.push(e[l].AD_ID);}var g=fcg.mdg.editbp.handlers.Communication.oCreateModel;for(var m=0;m<g.length;m++){d.push(g[m].body.AD_ID);}this.createWPArrForTel(W,d);this.createWPArrForMob(W,d);this.createWPArrForFax(W,d);this.createWPArrForEmail(W,d);this.createWPArrForIAV(W,d);},createWPArrForTel:function(c,w){var t=[],d=[];var W="",e="",f,g,h;for(var k=0;k<c.length;k++){if(c[k].entity==="BP_WorkplaceCommPhonesRel"){d.push(c[k]);}}if(d.length===0){return;}d.sort(function(a,b){return parseInt(a.wpKey,10)-parseInt(b.wpKey,10)||parseInt(a.currentEntityKey,10)-parseInt(b.currentEntityKey,10);});for(var i=0;i<d.length;i++){h={};if(W===""){W=d[i].wpKey;f=d[i].addrIndex;g=w[f];g=fcg.mdg.editbp.handlers.ContactPersonCreate.aWpIds.indexOf(g);}if(W!==d[i].wpKey){this.wpArray[g].BP_WorkplaceCommPhonesRel=t;t=[];}if(e===d[i].currentEntityKey&&W===d[i].wpKey){continue;}W=d[i].wpKey;f=d[i].addrIndex;g=w[f];g=fcg.mdg.editbp.handlers.ContactPersonCreate.aWpIds.indexOf(g);for(var j=0;j<d.length;j++){if(d[i].currentEntityKey===d[j].currentEntityKey&&d[i].wpKey===d[j].wpKey){e=d[i].currentEntityKey;h[d[j].field]=d[j].value;if(this.oController.vTimedependency==="X"){h.VALIDUNTILDATE="9999-12-31T00:00:00";}if(d[j].currentEntityKey==="0"){h.R_3_USER="1";h.STD_NO="X";}else{h.R_3_USER="";}}}t.push(h);}if(t.length>0){this.wpArray[g].BP_WorkplaceCommPhonesRel=t;}},createWPArrForMob:function(c,w){var m=[],d=[];var W="",e="",f,g,h;for(var k=0;k<c.length;k++){if(c[k].entity==="BP_WorkplaceCommMobilesRel"){d.push(c[k]);}}if(d.length===0){return;}d.sort(function(a,b){return parseInt(a.wpKey,10)-parseInt(b.wpKey,10)||parseInt(a.currentEntityKey,10)-parseInt(b.currentEntityKey,10);});for(var i=0;i<d.length;i++){h={};if(d[i].entity==="BP_WorkplaceCommMobilesRel"){if(W===""){W=d[i].wpKey;f=d[i].addrIndex;g=w[f];g=fcg.mdg.editbp.handlers.ContactPersonCreate.aWpIds.indexOf(g);}if(W!==d[i].wpKey){this.wpArray[g].BP_WorkplaceCommMobilesRel=m;m=[];}if(e===d[i].currentEntityKey&&W===d[i].wpKey){continue;}W=d[i].wpKey;f=d[i].addrIndex;g=w[f];g=fcg.mdg.editbp.handlers.ContactPersonCreate.aWpIds.indexOf(g);for(var j=0;j<d.length;j++){if(d[i].currentEntityKey===d[j].currentEntityKey&&d[i].wpKey===d[j].wpKey){e=d[i].currentEntityKey;h[d[j].field]=d[j].value;if(this.oController.vTimedependency==="X"){h.VALIDUNTILDATE="9999-12-31T00:00:00";}if(d[j].currentEntityKey==="0"){h.R_3_USER="3";h.STD_NO="X";}else{h.R_3_USER="2";}}}m.push(h);}}if(m.length>0){this.wpArray[g].BP_WorkplaceCommMobilesRel=m;}},createWPArrForFax:function(c,w){var f=[],d=[];var W="",e="",g,h,l;for(var k=0;k<c.length;k++){if(c[k].entity==="BP_WorkplaceCommFaxesRel"){d.push(c[k]);}}if(d.length===0){return;}d.sort(function(a,b){return parseInt(a.wpKey,10)-parseInt(b.wpKey,10)||parseInt(a.currentEntityKey,10)-parseInt(b.currentEntityKey,10);});for(var i=0;i<d.length;i++){h={};if(d[i].entity==="BP_WorkplaceCommFaxesRel"){if(W===""){W=d[i].wpKey;g=d[i].addrIndex;l=w[g];l=fcg.mdg.editbp.handlers.ContactPersonCreate.aWpIds.indexOf(l);}if(W!==d[i].wpKey){this.wpArray[l].BP_WorkplaceCommFaxesRel=f;f=[];}if(e===d[i].currentEntityKey&&W===d[i].wpKey){continue;}W=d[i].wpKey;g=d[i].addrIndex;l=w[g];l=fcg.mdg.editbp.handlers.ContactPersonCreate.aWpIds.indexOf(l);for(var j=0;j<d.length;j++){if(d[i].currentEntityKey===d[j].currentEntityKey&&d[i].wpKey===d[j].wpKey){e=d[i].currentEntityKey;h[d[j].field]=d[j].value;if(this.oController.vTimedependency==="X"){h.VALIDUNTILDATE="9999-12-31T00:00:00";}if(d[j].currentEntityKey==="0"){h.STD_NO="X";}}}f.push(h);}}if(f.length>0){this.wpArray[l].BP_WorkplaceCommFaxesRel=f;}},createWPArrForEmail:function(c,w){var e=[],d=[];var W="",f="",g,h,l;for(var k=0;k<c.length;k++){if(c[k].entity==="BP_WorkplaceCommEMailsRel"){d.push(c[k]);}}if(d.length===0){return;}d.sort(function(a,b){return parseInt(a.wpKey,10)-parseInt(b.wpKey,10)||parseInt(a.currentEntityKey,10)-parseInt(b.currentEntityKey,10);});for(var i=0;i<d.length;i++){h={};if(d[i].entity==="BP_WorkplaceCommEMailsRel"){if(W===""){W=d[i].wpKey;g=d[i].addrIndex;l=w[g];l=fcg.mdg.editbp.handlers.ContactPersonCreate.aWpIds.indexOf(l);}if(W!==d[i].wpKey){this.wpArray[l].BP_WorkplaceCommEMailsRel=e;e=[];}if(f===d[i].currentEntityKey&&W===d[i].wpKey){continue;}W=d[i].wpKey;g=d[i].addrIndex;l=w[g];l=fcg.mdg.editbp.handlers.ContactPersonCreate.aWpIds.indexOf(l);for(var j=0;j<d.length;j++){if(d[i].currentEntityKey===d[j].currentEntityKey&&d[j].wpKey===d[i].wpKey){f=d[i].currentEntityKey;h[d[j].field]=d[j].value;if(this.oController.vTimedependency==="X"){h.VALIDUNTILDATE="9999-12-31T00:00:00";}if(d[j].currentEntityKey==="0"){h.STD_NO="X";}}}e.push(h);}}if(e.length>0){this.wpArray[l].BP_WorkplaceCommEMailsRel=e;}},createWPArrForIAV:function(c,w){var d=[],e=[];var W="",f="",g,h,l,m;for(var k=0;k<c.length;k++){if(c[k].entity==="BP_WorkplaceIntAddressVersRel"||c[k].entity==="BP_WorkplaceIntPersVersionRel"){e.push(c[k]);}}if(e.length===0){return;}e.sort(function(a,b){return parseInt(a.wpKey,10)-parseInt(b.wpKey,10)||parseInt(a.currentEntityKey,10)-parseInt(b.currentEntityKey,10);});for(var i=0;i<e.length;i++){h={};l={};if(e[i].entity==="BP_WorkplaceIntAddressVersRel"){if(W===""){W=e[i].wpKey;g=e[i].addrIndex;m=w[g];m=fcg.mdg.editbp.handlers.ContactPersonCreate.aWpIds.indexOf(m);}if(W!==e[i].wpKey){this.wpArray[m].BP_WorkplaceIntAddressVersRel=d;d=[];}if(f===e[i].currentEntityKey&&W===e[i].wpKey){continue;}W=e[i].wpKey;g=e[i].addrIndex;m=w[g];m=fcg.mdg.editbp.handlers.ContactPersonCreate.aWpIds.indexOf(m);for(var j=0;j<e.length;j++){if(e[j].entity==="BP_WorkplaceIntAddressVersRel"&&e[j].currentEntityKey===e[i].currentEntityKey&&e[j].wpKey===e[i].wpKey){f=e[i].currentEntityKey;if(e[j].key!==undefined){h[e[j].field]=e[j].key;if(e[j].field==="ADDR_VERS"){l[e[j].field+"__TXT"]=e[j].value;}}else{h[e[j].field]=e[j].value;}if(this.oController.vTimedependency==="X"){h.VALIDUNTILDATE="9999-12-31T00:00:00";}if(e[j].currentEntityKey==="0"){h.STANDARDADDRESS="X";}}if(e[j].entity==="BP_WorkplaceIntPersVersionRel"&&e[i].currentEntityKey===e[j].currentEntityKey&&e[j].wpKey===e[i].wpKey){f=e[i].currentEntityKey;if(e[j].key!==undefined){l[e[j].field]=e[j].key;if((e[j].field==="TITLE_P")||(e[j].field==="ADDR_VERS")){l[e[j].field+"__TXT"]=e[j].value;}}else{l[e[j].field]=e[j].value;}}}l.ADDR_VERS=h.ADDR_VERS;h.BP_WorkplaceIntPersVersionRel=l;d.push(h);}}if(d.length>0){this.wpArray[m].BP_WorkplaceIntAddressVersRel=d;}},prepareEntityData:function(s,f,c){var o=s;var u="{";if(f===false){if(c.key!==undefined){o=u+"\""+c.field+"\":\""+c.key+"\",";o=o+"\""+c.field+"__TXT"+"\":\""+c.value+"\",";}else{o=u+"\""+c.field+"\":\""+c.value+"\",";}}else{if(c.key!==undefined){o=o+"\""+c.field+"\":\""+c.key+"\",";o=o+"\""+c.field+"__TXT"+"\":\""+c.value+"\",";}else{o=o+"\""+c.field+"\":\""+c.value+"\",";}}return o;},pad:function(s,m){var v=s.toString();return v.length<m?this.pad("0"+v,m):v;},getCurrentDate:function(){var c=new Date();c=c.toJSON().toString();c=c.substr(0,19);return c;},getCPModel:function(){if(this.oController.vCurrentActionId==="createRB"){return this.oCPModel;}else if(this.oController.vCurrentActionId==="changeRB"){return fcg.mdg.editbp.handlers.ContactPersonChange.ocpChangeModel;}else if(this.oController.vCurrentActionId==="deleteRB"){return fcg.mdg.editbp.handlers.ContactPersonChange.oCPDeleteModel;}},getDispCPModel:function(){if(this.oController.vCurrentActionId==="changeRB"){return fcg.mdg.editbp.handlers.ContactPersonChange.oCPData;}else{return this.oDispCPModel;}},setRelResults:function(r){this.oRelResults=r;},getRelResults:function(){return this.oRelResults;},onChange_Create:function(e){fcg.mdg.editbp.handlers.ContactPerson.oController.onChange(e);},onCPTelCountrykey:function(e){var t=e.getParameters().id;t=sap.ui.getCore().byId(t);fcg.mdg.editbp.handlers.ContactPerson.oController.countryCPVH(t,e);},onCPMobCountrykey:function(e){var m=e.getParameters().id;m=sap.ui.getCore().byId(m);fcg.mdg.editbp.handlers.ContactPerson.oController.countryCPVH(m,e);},onCPFaxCountrykey:function(e){var f=e.getParameters().id;f=sap.ui.getCore().byId(f);fcg.mdg.editbp.handlers.ContactPerson.oController.countryCPVH(f,e);},onFirstNameChange:function(e){this.ChangeDeferred=jQuery.Deferred();var n=sap.ui.getCore().byId("SF-BP_Person-FirstName");var p=sap.ui.getCore().byId("SF-BP_Relation-partnerId");n.attachEventOnce("change",function(){},this);var f=n.getValue();if(f.replace(/^[ ]+|[ ]+$/g,'')===""){n.setValue("");}var t=p.getValueStateText();if(t===this.oController.i18nBundle.getText("ERROR_PARTNER_CHECK")||p.getValueState()==="Warning"){p.setValueState("None");p.setValueStateText("");}fcg.mdg.editbp.handlers.ContactPerson.oController.onChange(e);},onLastNameChange:function(e){this.ChangeDeferred=jQuery.Deferred();var n=sap.ui.getCore().byId("SF-BP_Person-LastName");var p=sap.ui.getCore().byId("SF-BP_Relation-partnerId");p.attachEventOnce("change",function(){},this);var l=n.getValue();if(l.replace(/^[ ]+|[ ]+$/g,'')===""){n.setValue("");}var t=p.getValueStateText();if(t===this.oController.i18nBundle.getText("ERROR_PARTNER_CHECK")||p.getValueState()==="Warning"){p.setValueState("None");p.setValueStateText("");}fcg.mdg.editbp.handlers.ContactPerson.oController.onChange(e);},onTitleChange:function(e){var t=sap.ui.getCore().byId("SF-BP_RelationPartner-title");var g=sap.ui.getCore().byId("SF-BP_Person-Gender");if(t.getSelectedKey()==="0001"&&g.getSelectedKey()!=="1"){g.setSelectedKey("1");g.fireEvent("change");}if(t.getSelectedKey()==="0002"&&g.getSelectedKey()!=="2"){g.setSelectedKey("2");g.fireEvent("change");}fcg.mdg.editbp.handlers.ContactPerson.oController.onChange(e);},onGenderChange:function(e){var t=sap.ui.getCore().byId("SF-BP_RelationPartner-title");var g=sap.ui.getCore().byId("SF-BP_Person-Gender");if(g.getSelectedKey()==="1"&&t.getSelectedKey()!=="0001"){t.setSelectedKey("0001");t.fireEvent("change");}if(g.getSelectedKey()==="2"&&t.getSelectedKey()!=="0002"){t.setSelectedKey("0002");t.fireEvent("change");}fcg.mdg.editbp.handlers.ContactPerson.oController.onChange(e);},onChange:function(e){fcg.mdg.editbp.handlers.ContactPerson.oController.onChange(e);},onCorsLangChange:function(e){var c=sap.ui.getCore().byId("SF-BP_Person-LanguageKey");c.setValue(c.getValue().toUpperCase());var a=c.getValue();var b=a.replace(/^[ ]+|[ ]+$/g,'');b=b.toUpperCase();var C=sap.ui.getCore().byId("SF-BP_Person-LanguageDesc");var d=this.oController.aCorrLangValues;if(b!==""){var l=false;for(var i=0;i<d.results.length;i++){if(d.results[i].KEY===b){if(c.getValue()!==""){C.setValue(d.results[i].TEXT);c.setValueState("None");c.setValueStateText("");}l=true;C.fireEvent("change");break;}}if(l===false){C.setValue();c.setValueState("Error");var f="";f=this.oController.i18nBundle.getText("CLANG");var g=f+" "+c.getValue()+" "+this.oController.i18nBundle.getText("NO_EXISTENCE");c.setValueStateText(g);}}else{c.setValue();c.setValueStateText("");C.setValue();}fcg.mdg.editbp.handlers.ContactPerson.oController.onChange(e);},onCLangVH:function(){var a=this.oController.i18nBundle;var l=sap.ui.getCore().byId("SF-BP_Person-LanguageKey");var b=sap.ui.getCore().byId("SF-BP_Person-LanguageDesc");var c=this.oController.aCorrLangValues;if(sap.ui.getCore().byId("CorrespodingLangDialog")!==undefined){sap.ui.getCore().byId("CorrespodingLangDialog").destroy();}var s=new sap.m.SelectDialog({id:"CorrespodingLangDialog",title:a.getText("LANG"),noDataText:a.getText("LOAD")+"...",confirm:function(e){l.setValueState("None");l.setValueStateText("");l.setValue(e.getParameters().selectedItem.getProperty("description"));b.setValue(e.getParameters().selectedItem.getProperty("title"));sap.ui.getCore().byId("SF-BP_Person-LanguageKey").fireEvent("change");},search:function(e){var v=e.getParameter("value").toUpperCase();v=v.replace(/^[ ]+|[ ]+$/g,'');var d=s.getItems();for(var i=0;i<d.length;i++){if(v.length>0){var L=d[i].getBindingContext().getProperty("KEY");var f=d[i].getBindingContext().getProperty("TEXT");if(L.toUpperCase().indexOf(v)===-1&&f.toUpperCase().indexOf(v)===-1){d[i].setVisible(false);}else{d[i].setVisible(true);}}else{d[i].setVisible(true);}}},liveChange:function(e){var v=e.getParameter("value").toUpperCase();v=v.replace(/^[ ]+|[ ]+$/g,'');var d=s.getItems();for(var i=0;i<d.length;i++){if(v.length>0){var L=d[i].getBindingContext().getProperty("KEY");var f=d[i].getBindingContext().getProperty("TEXT");if(L.toUpperCase().indexOf(v)===-1&&f.toUpperCase().indexOf(v)===-1){d[i].setVisible(false);}else{d[i].setVisible(true);}}else{d[i].setVisible(true);}}}});if(!this.isNull(c)){if(c.results.length>0){var I=new sap.m.StandardListItem({title:"{TEXT}",description:"{KEY}",active:true});var o=new sap.ui.model.json.JSONModel();o.setData(c);s.setModel(o);s.setGrowingThreshold(c.results.length);s.bindAggregation("items","/results",I);}else{s.setNoDataText(a.getText("NO_DATA"));}}else{s.setNoDataText(a.getText("NO_DATA"));}s.open();},setWPAddressArray:function(r){var a="";var b=[];var o;if(this.oController.isAddressVisited==="X"){a=this.oController.oDetailComm.BP_AddressesRel.results;}else{a=r.BP_AddressesRel.results;}for(var i=0;i<a.length;i++){o={};o.AD_ID=a[i].AD_ID;o.AD_ID__TXT=a[i].AD_ID__TXT;o.ATTR_NAME="ADDRESS_NUMBER";b.push(o);}if(fcg.mdg.editbp.handlers.Communication.oCreateModel.length>0){var c=fcg.mdg.editbp.handlers.Communication.oCreateModel;for(var j=0;j<c.length;j++){o={};o.AD_ID=c[j].body.AD_ID;o.AD_ID__TXT=c[j].body.AD_ID__TXT;o.ATTR_NAME="ADDRESS_NUMBER";b.push(o);}}this.oWpAddressResults.results=b;},setWPIavArray:function(r){var a="";var b=[];var o,c,d;if(this.oController.isAddressVisited==="X"){a=this.oController.oDetailComm.BP_AddressesRel.results;}else{a=r.BP_AddressesRel.results;}for(var i=0;i<a.length;i++){o={};d=[];o.AD_ID=a[i].AD_ID;o.AD_ID__TXT=a[i].AD_ID__TXT;o.ATTR_NAME="ADDRESS_NUMBER";var e=a[i].BP_AddressVersionsOrgRel.results;for(var j=0;j<e.length;j++){c={};c.ADDR_VERS=e[j].ADDR_VERS;c.ADDR_VERS__TXT=e[j].ADDR_VERS__TXT;d.push(c);}o.IAV=d;b.push(o);}if(fcg.mdg.editbp.handlers.Communication.oCreateModel.length>0){var f=fcg.mdg.editbp.handlers.Communication.oCreateModel;var g=[];for(var k=0;k<f.length;k++){o={};d=[];o.AD_ID=f[k].body.AD_ID;o.AD_ID__TXT=f[k].body.AD_ID__TXT;o.ATTR_NAME="ADDRESS_NUMBER";if(f[k].body.BP_AddressVersionsOrgRel!==undefined){g=f[k].body.BP_AddressVersionsOrgRel.results;}for(var l=0;l<g.length;l++){c={};c.ADDR_VERS=g[l].ADDR_VERS;c.ADDR_VERS__TXT=g[l].ADDR_VERS__TXT;d.push(c);}o.IAV=d;b.push(o);}}this.oWpIavResults.results=b;},getWPAddressArray:function(){return this.oWpAddressResults;},getWPIavArray:function(){return this.oWpIavResults;},isNull:function(v){return typeof v==="undefined"||v==="unknown"||v===null||v==="null"||v===""||parseInt(v,10)===0;},onPartnerVH:function(){var w=fcg.mdg.editbp.handlers.ContactPerson.oController;var i=w.i18nBundle;var f=sap.ui.getCore().byId("SF-BP_Person-FirstName").getValue();var l=sap.ui.getCore().byId("SF-BP_Person-LastName").getValue();var p=sap.ui.getCore().byId("SF-BP_Relation-partnerId");var q;var a;if(l===""&&f===""){p.setValueState("Warning");p.setValueStateText(i.getText("ERROR_PARTNER_CHECK"));return;}else if(f===""&&l!==""){a="LastName eq '"+l+"'";}else if(l===""&&f!==""){a="FirstName eq '"+f+"'";}else{a="FirstName eq '"+f+"' and LastName eq '"+l+"'";}if(this.oDialogCP){this.oDialogCP.destroy();}this.oDialogCP=sap.ui.xmlfragment("fcg.mdg.editbp.frag.bp.DuplicateContactPersonList",this);var I=new sap.ui.model.json.JSONModel();fcg.mdg.editbp.handlers.ContactPerson.oPartnerModel=new sap.ui.model.odata.ODataModel(w.getView().getModel().sServiceUrl,true);var g=this;q="/SearchContactPersons?$filter=";q=q+jQuery.sap.encodeURL(a);var t={"results":[]};fcg.mdg.editbp.handlers.ContactPerson.oPartnerModel.read(q,null,null,true,function(d,e){var c=fcg.mdg.editbp.handlers.ContactPerson.aCPQueryModel;for(var z=0;z<d.results.length;z++){var C=false;for(var k=0;k<c.length;k++){if(parseInt(c[k].partner2,10)===parseInt(d.results[z].CpId,10)){C=true;break;}}if(!C){if(p.getValue()!==""){if(p.getValue()!==d.results[z].CpId){t.results.push(d.results[z]);}}else{t.results.push(d.results[z]);}}}I.setData(t);if(t.results.length>0){var L=new sap.ui.model.resource.ResourceModel({bundleUrl:jQuery.sap.getModulePath("fcg.mdg.editbp")+"/i18n/i18n.properties"});L.setDefaultBindingMode(sap.ui.model.BindingMode.OneTime);g.oDialogCP.setModel(L,"i18n");g.oDialogCP.setContentWidth("50%");g.oDialogCP.setModel(I);g.oDialogCP.open();}else{p.setValueState("Warning");if(d.results.length===0){p.setValueStateText(i.getText("MSG_NO_CP_DATA"));}else{p.setValueStateText(i.getText("MSG_NO_FURTHER_CP_DATA"));}}},function(e){});},handleSearch:function(e){var w=fcg.mdg.editbp.handlers.ContactPerson.oController;var i=w.i18nBundle;var g=this;var v=e.getParameter("value");var f=new sap.ui.model.Filter([new sap.ui.model.Filter("CpDesc",sap.ui.model.FilterOperator.Contains,v),new sap.ui.model.Filter("CpId",sap.ui.model.FilterOperator.Contains,v),new sap.ui.model.Filter("AssignedOrgDesc",sap.ui.model.FilterOperator.Contains,v),new sap.ui.model.Filter("AssignedOrgId",sap.ui.model.FilterOperator.Contains,v)],false);var b=e.getSource().getBinding("items");b.filter([f]);var t=sap.ui.getCore().byId("duplicateCPList");if(t.getItems().length===0){g.oDialogCP.setNoDataText(i.getText("MSG_NO_CP_DATA"));}else{g.oDialogCP.setNoDataText(i.getText("LOAD"));}},handleClose:function(e){var w=fcg.mdg.editbp.handlers.ContactPerson.oController;var i=w.i18nBundle;var c=e.getParameter("selectedContexts");var n=sap.ui.getCore().byId("SF-BP_Person-FirstName");var l=sap.ui.getCore().byId("SF-BP_Person-LastName");var p=sap.ui.getCore().byId("SF-BP_Relation-partnerId");var a=sap.ui.getCore().byId("SF-BP_Person-LanguageKey");var b=sap.ui.getCore().byId("SF-BP_Person-LanguageDesc");var t=sap.ui.getCore().byId("SF-BP_RelationPartner-title");var d=sap.ui.getCore().byId("SF-BP_Person-AcadTitle");var g=sap.ui.getCore().byId("SF-BP_Person-Gender");var C=w.aCorrLangValues;if(this.isNull(c)){return;}if(c.length){var s=c[0].getObject();var f=false;this.cpDesc=fcg.mdg.editbp.util.Formatter.descriptionAndCode(s.CpDesc,s.CpId);var h=[n,l,g,t,d,a];var k=[a,b];n.setValue(s.FirstName);n.fireEvent("change");l.setValue(s.LastName);l.fireEvent("change");p.setValue(s.CpId);p.setValueState("None");g.setSelectedKey(s.CpGender);g.fireEvent("change");t.setSelectedKey(s.CpTitle);t.fireEvent("change");d.setSelectedKey(s.CpAcademicTitle);d.fireEvent("change");this.setEnableForFields(h,false);if(!this.isNull(C)){if(C.results.length>0&&s.CpCorrLang!==""){for(var j=0;j<C.results.length;j++){if(s.CpCorrLang===C.results[j].KEY){b.setValue(C.results[j].TEXT);a.setValue(C.results[j].KEY);a.fireEvent("change");break;}}}else{this.setValueForFieds(k,"");}}else{this.setValueForFieds(k,"");}var m=[n,l,p];if(f){n.setEnabled(true);l.setEnabled(true);this.setValueStateForFieds(m,"Error");this.setValueStateTextForFieds(m,i.getText("DUPLICATE_CP_CHECK"));}else{n.setEnabled(false);l.setEnabled(false);this.setValueStateForFieds(m,"None");this.setValueStateTextForFieds(m,"");}fcg.mdg.editbp.handlers.ContactPerson.onPartnerIdChange();}e.getSource().getBinding("items").filter([]);},partnerIdChange:function(c){sap.ui.getCore().byId("SF-BP_Relation-partnerId").setValueState("None");},onPartnerIdChange:function(e){this.ChangeDeferred=jQuery.Deferred();var w=fcg.mdg.editbp.handlers.ContactPerson.oController;var a=w.i18nBundle;var n=sap.ui.getCore().byId("SF-BP_Person-FirstName");var l=sap.ui.getCore().byId("SF-BP_Person-LastName");var p=sap.ui.getCore().byId("SF-BP_Relation-partnerId");var b=sap.ui.getCore().byId("SF-BP_Person-LanguageKey");var c=sap.ui.getCore().byId("SF-BP_Person-LanguageDesc");var t=sap.ui.getCore().byId("SF-BP_RelationPartner-title");var d=sap.ui.getCore().byId("SF-BP_Person-AcadTitle");var g=sap.ui.getCore().byId("SF-BP_Person-Gender");var C=w.aCorrLangValues;var f=[n,l,g,t,d,b];var h=[n,l,p];var k=[b,c];var G=this;p.attachEventOnce("change",function(){},this);var m=p.getValue();m=m.trim();var q;var E="";if(m!==""){E=jQuery.sap.encodeURL("CpId eq '"+m+"' and ChangeRequestType eq '"+w.crType+"'");fcg.mdg.editbp.handlers.ContactPerson.oPartnerModel=new sap.ui.model.odata.ODataModel(w.getView().getModel().sServiceUrl,true);var I="";G.vgIsLocked="";q="/SearchContactPersons?$filter="+E;fcg.mdg.editbp.handlers.ContactPerson.oPartnerModel.read(q,null,null,false,function(r,s){var u="";var v="";if(s.headers["sap-message"]!==undefined){u=s.headers["sap-message"];var x=JSON.parse(u);v=x.message;}if(r.results.length>0){var y=fcg.mdg.editbp.handlers.ContactPerson.aCPQueryModel;var z=false;for(var i=0;i<y.length;i++){if(parseInt(m,10)===parseInt(y[i].partner2,10)){z=true;break;}}I=r.results[0].IsLocked;G.vgIsLocked=I;n.setValue(r.results[0].FirstName);l.setValue(r.results[0].LastName);g.setSelectedKey(r.results[0].CpGender);t.setSelectedKey(r.results[0].CpTitle);d.setSelectedKey(r.results[0].CpAcademicTitle);n.fireEvent("change");l.fireEvent("change");g.fireEvent("change");t.fireEvent("change");d.fireEvent("change");if(z){n.setValueState("Error");l.setValueState("Error");n.setValueStateText(a.getText("DUPLICATE_CP_CHECK"));l.setValueStateText(a.getText("DUPLICATE_CP_CHECK"));p.setValueState("Error");p.setValueStateText(a.getText("DUPLICATE_CP_CHECK"));n.setEnabled(true);l.setEnabled(true);t.setEnabled(false);d.setEnabled(false);b.setEnabled(false);g.setEnabled(false);}else{G.setValueStateForFieds([n,l],"None");G.setValueStateTextForFieds([n,l],"");G.setEnableForFields(f,false);if(I){p.setValueState("Warning");p.setValueStateText(v);}else{p.setValueState("None");p.setValueStateText("");}}if(!G.isNull(C)){if(C.results.length>0&&r.results[0].CpCorrLang!==""){for(var j=0;j<C.results.length;j++){if(r.results[0].CpCorrLang===C.results[j].KEY){c.setValue(C.results[j].TEXT);b.setValue(C.results[j].KEY);b.fireEvent("change");break;}}}else{G.setValueForFieds(k,"");}}else{G.setValueForFieds(k,"");}fcg.mdg.editbp.handlers.ContactPersonCreate.deleteWorkplaceAddress();if(!z){fcg.mdg.editbp.handlers.ContactPerson.getBPGuid2(r.results[0].CpId);}}else{p.setValueState("Error");p.setValueStateText(a.getText("PARTNERID_CHECK"));G.setValueForFieds([n,l,b,c],"");G.setValueStateForFieds([n,l],"None");G.setValueStateTextForFieds([n,l],"");g.setSelectedKey();t.setSelectedKey();d.setSelectedKey();n.fireEvent("change");l.fireEvent("change");g.fireEvent("change");t.fireEvent("change");d.fireEvent("change");b.fireEvent("change");G.setEnableForFields(f,true);}G.ChangeDeferred.resolve();},function(i){});}else{if(!n.getEnabled()){G.setValueForFieds([n,l,b,c],"");g.setSelectedKey();t.setSelectedKey();d.setSelectedKey();this.setEnableForFields(f,true);this.setValueStateForFieds(h,"None");this.setValueStateTextForFieds(h,"");}else{if(n.getValue()!==""){n.setValue("");}if(l.getValue()!==""){l.setValue("");}this.setValueForFieds(k,"");this.setValueStateForFieds([n,l],"None");this.setEnableForFields(f,true);g.setSelectedKey();t.setSelectedKey();d.setSelectedKey();}n.fireEvent("change");l.fireEvent("change");g.fireEvent("change");t.fireEvent("change");d.fireEvent("change");b.fireEvent("change");this.ChangeDeferred.resolve();}var o={};o.value=p.getValue();o.entity="BP_Relation";o.field="PARTNER2";if(w.vCurrentActionId==="createRB"){for(var j=0;j<w.createdArray.length;j++){if(w.createdArray[j].field===o.field&&w.createdArray[j].entity===o.entity){w.createdArray[j].value=o.value;return;}}w.createdArray.push(o);}},getBPGuid2:function(p){var a="SearchCollection?$filter="+jQuery.sap.encodeURL("PARTNER eq '"+p+"'");var b=new sap.ui.model.odata.ODataModel("/sap/opu/odata/sap/MDG_EDIT_CUSTOMER",true);var m={};b.getHeaders(m);m.SEARCH_MODE="DB";b.setHeaders(m);b.setUseBatch(true);var B=[];var o=b.createBatchOperation(a,"GET");B.push(o);b.clearBatch();b.addBatchReadOperations(B);B=[];b.submitBatch(function(c,r){var d=JSON.parse(c.__batchResponses[0].body);var g=d.d.results[0].BP_RootToSearchRel.__deferred.uri;var s=g.indexOf("'")+1;var e=g.indexOf(")")-1;g=g.substring(s,e);fcg.mdg.editbp.handlers.ContactPerson.vBPguid2=g;fcg.mdg.editbp.handlers.ContactPerson.getContactPersonAddressData(g);},null,false);b.clearBatch();},getContactPersonAddressData:function(b,a){var w=fcg.mdg.editbp.handlers.ContactPerson.oController;var p="/BP_RootCollection(BP_GUID=binary'"+b+"')?$expand=";var P=p+"BP_AddressesRel,BP_AddressesRel/BP_AddressVersionsPersRel/BP_AddressPersonVersionRel,BP_AddressUsagesRel";var d=new sap.ui.model.odata.ODataModel(w.getView().getModel().sServiceUrl,false);d.read(P,null,null,false,function(r){for(var i=0;i<r.BP_AddressUsagesRel.results.length;i++){if(r.BP_AddressUsagesRel.results[i].ADDRESSTYPE==="XXDEFAULT"){for(var j=0;j<r.BP_AddressesRel.results.length;j++){if(r.BP_AddressesRel.results[j].AD_ID!==r.BP_AddressUsagesRel.results[i].AD_ID){r.BP_AddressesRel.results.splice(j,1);}}}}fcg.mdg.editbp.handlers.ContactPerson.standardAddress=r.BP_AddressesRel.results;});},setValueForFieds:function(f,v){for(var i=0;i<f.length;i++){f[i].setValue(v);}},setValueStateForFieds:function(f,s){for(var i=0;i<f.length;i++){f[i].setValueState(s);}},setValueStateTextForFieds:function(f,s){for(var i=0;i<f.length;i++){f[i].setValueStateText(s);}},setEnableForFields:function(f,s){for(var i=0;i<f.length;i++){f[i].setEnabled(s);}},removeDuplicate:function(c){var n=[];var f,a,b;for(var i=0;i<c.length;i++){f=false;a=JSON.stringify(c[i]);for(var j=0;j<n.length;j++){b=JSON.stringify(n[j]);if(a===b){f=true;break;}}if(f===false){n[i]=c[j];}}return n;},performUIValidations:function(w){var e="";var p=sap.ui.getCore().byId("SF-BP_Relation-partnerId");if(p.getValueState()==="Error"){e=w.i18nBundle.getText("ERROR_CHECK");this.showPopUp(w,e);return false;}var l=sap.ui.getCore().byId("SF-BP_Person-LanguageKey");var c=w.aCorrLangValues;if(l.getValue()!==""){var a=false;l.setValue(l.getValue().toUpperCase());var L=l.getValue();for(var i=0;i<c.results.length;i++){if(w.vCurrentActionId==="createRB"&&c.results[i].KEY===L){a=true;break;}if(w.vCurrentActionId==="changeRB"&&c.results[i].KEY===L){a=true;break;}}if(a===false){var f="";if(w.sCategory==="2")f=w.i18nBundle.getText("LANGUAGE");e=f+" "+L+" "+w.i18nBundle.getText("NO_EXISTENCE");this.showPopUp(w,e);return false;}}var b=jQuery('.sapMInputBaseErrorInner');if(b.length!==0){e=w.i18nBundle.getText("ERROR_CHECK");this.showPopUp(w,e);return false;}var d=w.createdArray;var g;var h;if(w.vCurrentActionId==="createRB"){g=false;h=true;for(var j=0;j<d.length;j++){if(d[j].field.indexOf("__TXT")!==-1){continue;}if(d[j].value!==""&&d[j].value!=="None"){g=true;break;}}for(var k=0;k<d.length;k++){if(d[k].entity==="BP_ContactPersonWorkplacesRel"||d[k].entity.indexOf("BP_Workplace")!==-1){h=false;if(d[k].key!==undefined&&d[k].key!==""){h=true;break;}}}}if(g===false||h===false){e=w.i18nBundle.getText("ERROR_CHECK");this.showPopUp(w,e);return false;}},showPopUp:function(w,t){var d=new sap.m.Dialog({title:w.i18nBundle.getText("ERROR"),type:"Message",state:w.i18nBundle.getText("ERROR"),content:[new sap.m.Text({text:t})],beginButton:new sap.m.Button({text:w.i18nBundle.getText("OK"),press:function(){d.close();}}),afterClose:function(){d.destroy();}});d.open();}};
