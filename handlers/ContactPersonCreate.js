/*
 * Copyright (C) 2009-2018 SAP SE or an SAP affiliate company. All rights reserved.
 */
jQuery.sap.declare("fcg.mdg.editbp.handlers.ContactPersonCreate");fcg.mdg.editbp.handlers.ContactPersonCreate={countryError:false,oWPIavModel:"",oExistingIav:"",vIsWPASelected:"",aWpIds:[],addWPAddress:function(){fcg.mdg.editbp.handlers.ContactPersonChange.oWPModel="";fcg.mdg.editbp.handlers.ContactPersonCreate.addNewWPAddress();},addNewWPAddress:function(){var w=fcg.mdg.editbp.handlers.ContactPerson.oController;var f=w.getView().byId("editLayout").getContent().length-1;var a=fcg.mdg.editbp.handlers.ContactPerson.oWpFormId;var t=0;var m=0;var b=0;var e=0;var d=w.i18nBundle.getText("NONE");var c={};if(fcg.mdg.editbp.handlers.ContactPersonChange.oController.vCurrentActionId==="createRB"){c.cpId="T1";}else if(fcg.mdg.editbp.handlers.ContactPersonChange.oController.vCurrentActionId==="changeRB"){var s;if(fcg.mdg.editbp.handlers.ContactPerson.oRelResults.BP_RelationsRel.results.length===1){s=0;}else{if(sap.ui.getCore().byId("selectDataListRBG")!==undefined){s=sap.ui.getCore().byId("selectDataListRBG").getSelectedIndex();}}c.cpId=fcg.mdg.editbp.handlers.ContactPerson.oRelResults.BP_RelationsRel.results[s].PARTNER1;}c.formId=a;c.telId=t;c.mobId=m;c.faxId=b;c.emailId=e;fcg.mdg.editbp.handlers.ContactPerson.aAllCounters.push(c);fcg.mdg.editbp.handlers.ContactPerson.oWpFormId=a+1;var g=fcg.mdg.editbp.handlers.ContactPerson.getWPAddressArray();var h=g.results.length;var p=sap.ui.getCore().byId("INP-BP_ContactPersonWorkplacesRel-Addr_Num-"+(a-1));if(p!==undefined&&p.getSelectedKey()===""){return;}if(h<1){return;}var n=new sap.ui.layout.form.SimpleForm({id:"SFWpAddressEdit-"+a,maxContainerCols:1,minWidth:1024,layout:"ResponsiveGridLayout",labelSpanL:3,labelSpanM:3,emptySpanL:4,emptySpanS:0,emptySpanM:4,labelSpanS:12,editable:true,"class":"paddingFixSF"});fcg.mdg.editbp.handlers.ContactPersonCreate.addWPToolBar(n,w,h);var l=new sap.m.Label({text:w.i18nBundle.getText("Address")});n.addContent(l);var i=new sap.m.Select({id:"INP-BP_ContactPersonWorkplacesRel-Addr_Num-"+a,change:fcg.mdg.editbp.handlers.ContactPersonCreate.onAddressChange});var A=new sap.ui.model.json.JSONModel();A.setData(g);var j=new sap.ui.core.Item({key:"{AD_ID}",text:"{AD_ID__TXT}"});i.setModel(A);i.bindItems("/results",j);if(h>1){var k=new sap.ui.core.Item({key:"",text:d});i.addItem(k);i.setSelectedKey();}else{i.setSelectedItem(i.getItems()[0]);}n.addContent(i);var o=new sap.m.Label({text:w.i18nBundle.getText("DEPARTMENT")});n.addContent(o);var q=new sap.m.Input({id:"INP-BP_ContactPersonWorkplacesRel-Department-"+a,value:"{WP>/DEPARTMENT}",maxLength:40,change:fcg.mdg.editbp.handlers.ContactPerson.onChange_Create,enabled:false});n.addContent(q);var u=new sap.m.Label({text:w.i18nBundle.getText("FUNCTION")});n.addContent(u);var v=new sap.m.Input({id:"INP-BP_ContactPersonWorkplacesRel-Function-"+a,value:"{WP>/FUNCTION}",maxLength:40,change:fcg.mdg.editbp.handlers.ContactPerson.onChange_Create,enabled:false});n.addContent(v);var x=new sap.m.Label({text:w.i18nBundle.getText("TEL")});n.addContent(x);var y=new sap.m.Input({id:"INP-BP_WorkplaceCommPhonesRel-COUNTRY-"+t+"-"+a,value:"{tel>/COUNTRY}",maxLength:3,placeholder:w.i18nBundle.getText("CCITY"),valueHelpRequest:fcg.mdg.editbp.handlers.ContactPerson.onCPTelCountrykey,change:fcg.mdg.editbp.handlers.ContactPersonCreate.onTelCountryKeyChange,showValueHelp:true,enabled:false,layoutData:new sap.ui.layout.GridData({span:"L2 M2 S2"})});n.addContent(y);var z=new sap.m.Input({id:"INP-BP_WorkplaceCommPhonesRel-TELEPHONE-"+t+"-"+a,value:"{tel>/TELEPHONE}",maxLength:30,placeholder:w.i18nBundle.getText("Number"),change:fcg.mdg.editbp.handlers.ContactPersonCreate.onTelephoneChange,enabled:false,layoutData:new sap.ui.layout.GridData({span:"L2 M2 S2"})});n.addContent(z);var B=new sap.m.Input({id:"INP-BP_WorkplaceCommPhonesRel-EXTENSION-"+t+"-"+a,value:"{tel>/EXTENSION}",maxLength:10,placeholder:w.i18nBundle.getText("Extension"),change:fcg.mdg.editbp.handlers.ContactPersonCreate.onExtensionChange,enabled:false,layoutData:new sap.ui.layout.GridData({span:"L1 M1 S1"})});n.addContent(B);var C=fcg.mdg.editbp.handlers.ContactPersonCreate.addPlusIcons("Tel",a);var D=new sap.ui.core.Icon({id:"telCPCancel-"+a,decorative:false,src:"sap-icon://sys-cancel",tooltip:"Cancel"});C.addItem(D);n.addContent(C);sap.ui.getCore().byId("telCPCancel-"+a).addStyleClass("sapGreyCell");var E=new sap.m.Label({text:w.i18nBundle.getText("MOB")});n.addContent(E);var F=new sap.m.Input({id:"INP-BP_WorkplaceCommMobilesRel-COUNTRY-"+m+"-"+a,value:"{mob>/COUNTRY}",maxLength:3,placeholder:w.i18nBundle.getText("CCITY"),change:fcg.mdg.editbp.handlers.ContactPersonCreate.onMobCountryKeyChange,valueHelpRequest:fcg.mdg.editbp.handlers.ContactPerson.onCPMobCountrykey,showValueHelp:true,layoutData:new sap.ui.layout.GridData({span:"L2 M2 S2"}),enabled:false});n.addContent(F);var G=new sap.m.Input({id:"INP-BP_WorkplaceCommMobilesRel-TELEPHONE-"+m+"-"+a,value:"{mob>/TELEPHONE}",maxLength:30,placeholder:w.i18nBundle.getText("Number"),change:fcg.mdg.editbp.handlers.ContactPersonCreate.onMobChange,layoutData:new sap.ui.layout.GridData({span:"L3 M3 S3"}),enabled:false});n.addContent(G);var H=fcg.mdg.editbp.handlers.ContactPersonCreate.addPlusIcons("Mob",a);var I=new sap.ui.core.Icon({id:"mobCPCancel-"+a,decorative:false,src:"sap-icon://sys-cancel",tooltip:"Cancel"});H.addItem(I);n.addContent(H);sap.ui.getCore().byId("mobCPCancel-"+a).addStyleClass("sapGreyCell");var J=new sap.m.Label({text:w.i18nBundle.getText("FAX")});n.addContent(J);var K=new sap.m.Input({id:"INP-BP_WorkplaceCommFaxesRel-COUNTRY-"+b+"-"+a,value:"{fax>/COUNTRY}",maxLength:3,placeholder:w.i18nBundle.getText("CCITY"),showValueHelp:true,valueHelpRequest:fcg.mdg.editbp.handlers.ContactPerson.onCPFaxCountrykey,change:fcg.mdg.editbp.handlers.ContactPersonCreate.onFaxCountryKeyChange,layoutData:new sap.ui.layout.GridData({span:"L2 M2 S2"}),enabled:false});n.addContent(K);var L=new sap.m.Input({id:"INP-BP_WorkplaceCommFaxesRel-FAX-"+b+"-"+a,value:"{fax>/FAX}",maxLength:30,placeholder:w.i18nBundle.getText("Number"),change:fcg.mdg.editbp.handlers.ContactPersonCreate.onFaxChange,layoutData:new sap.ui.layout.GridData({span:"L2 M2 S2"}),enabled:false});n.addContent(L);var M=new sap.m.Input({id:"INP-BP_WorkplaceCommFaxesRel-EXTENSION-"+b+"-"+a,value:"{fax>/EXTENSION}",maxLength:10,placeholder:w.i18nBundle.getText("Extension"),change:fcg.mdg.editbp.handlers.ContactPersonCreate.onFaxExtensionChange,layoutData:new sap.ui.layout.GridData({span:"L1 M1 S1"}),enabled:false});n.addContent(M);var N=fcg.mdg.editbp.handlers.ContactPersonCreate.addPlusIcons("Fax",a);var O=new sap.ui.core.Icon({id:"faxCPCancel-"+a,decorative:false,src:"sap-icon://sys-cancel",tooltip:"Cancel"});N.addItem(O);n.addContent(N);sap.ui.getCore().byId("faxCPCancel-"+a).addStyleClass("sapGreyCell");var P=new sap.m.Label({text:w.i18nBundle.getText("E_MAIL")});n.addContent(P);var Q=new sap.m.Input({id:"INP-BP_WorkplaceCommEMailsRel-E_MAIL-"+e+"-"+a,value:"{email>/E_MAIL}",maxLength:241,type:"Email",change:fcg.mdg.editbp.handlers.ContactPersonCreate.onEMailChange,layoutData:new sap.ui.layout.GridData({span:"L5 M5 S5"}),enabled:false});n.addContent(Q);var R=fcg.mdg.editbp.handlers.ContactPersonCreate.addPlusIcons("Email",a);var S=new sap.ui.core.Icon({id:"emailCPCancel-"+a,src:"sap-icon://sys-cancel",tooltip:"Cancel"});R.addItem(S);n.addContent(R);w.bpHookAddNewWPAddressCP(this,a,n);sap.ui.getCore().byId("emailCPCancel-"+a).addStyleClass("sapGreyCell");w.getView().byId("editLayout").insertContent(n,f);fcg.mdg.editbp.handlers.ContactPerson.oWpNewForm=n;fcg.mdg.editbp.handlers.ContactPerson.aWpNewForm.push(n);if(h===1){sap.ui.getCore().byId("INP-BP_ContactPersonWorkplacesRel-Addr_Num-"+a).fireEvent('change');sap.ui.getCore().byId("INP-BP_ContactPersonWorkplacesRel-Addr_Num-"+a).setEnabled(false);}if(sap.ui.getCore().byId("toolWPAdd").hasListeners("press")===true){sap.ui.getCore().byId("toolWPAdd").detachEvent("press");sap.ui.getCore().byId("toolWPAdd").detachPress(fcg.mdg.editbp.handlers.ContactPersonCreate.addWPAddress);sap.ui.getCore().byId("toolWPAdd").addStyleClass("sapGreyCell");}if(fcg.mdg.editbp.handlers.ContactPersonChange.oWPModel!==""){for(var r=0;r<fcg.mdg.editbp.handlers.ContactPerson.oWpAddressResults.results.length;r++){if(fcg.mdg.editbp.handlers.ContactPerson.oWpAddressResults.results[r].AD_ID===fcg.mdg.editbp.handlers.ContactPersonChange.oWPModel.getData().ADDRESS_NUMBER){i.setSelectedKey(fcg.mdg.editbp.handlers.ContactPersonChange.oWPModel.getData().ADDRESS_NUMBER);i.fireEvent("change");}}}},addIcons:function(s){var h=new sap.m.HBox({layoutData:new sap.ui.layout.GridData({span:"L1 M1 S1"})});h.addStyleClass("sapUiSmallMargin");var a=new sap.ui.core.Icon({src:"sap-icon://sys-add",decorative:false,press:function(e){if(s===("Email"))return fcg.mdg.editbp.handlers.ContactPersonCreate.addNewEmail(e);else if(s==="Tel")return fcg.mdg.editbp.handlers.ContactPersonCreate.addNewTel(e);else if(s==="Fax")return fcg.mdg.editbp.handlers.ContactPersonCreate.addNewFax(e);else if(s==="Mob")return fcg.mdg.editbp.handlers.ContactPersonCreate.addNewMob(e);},tooltip:"Add"});a.addStyleClass("sapUiSmallMarginEnd");h.addItem(a);var r=new sap.ui.core.Icon({src:"sap-icon://sys-cancel",decorative:false,press:fcg.mdg.editbp.handlers.ContactPersonCreate.removeFormElement,tooltip:"Cancel"});h.addItem(r);return h;},addPlusIcons:function(s,w){var i="";if(s==="Tel"){i="telCPAdd-"+w;}else if(s==="Mob"){i="mobCPAdd-"+w;}else if(s==="Fax"){i="faxCPAdd-"+w;}else if(s==="Email"){i="emailCPAdd-"+w;}var h=new sap.m.HBox({layoutData:new sap.ui.layout.GridData({span:"L1 M1 S1"})});h.addStyleClass("sapUiSmallMargin");var a=new sap.ui.core.Icon({id:i,decorative:false,src:"sap-icon://sys-add",tooltip:"Add"});a.addStyleClass("sapGreyCell");a.addStyleClass("sapUiSmallMarginEnd");h.addItem(a);return h;},addWPToolBar:function(f,w,a){var t=new sap.m.Title({text:w.i18nBundle.getText("ADD_WP_ADD"),level:"H4",titleStyle:"H4",layoutData:new sap.ui.layout.GridData({span:"L4 M4 S6"})});var h=new sap.m.HBox({layoutData:new sap.ui.layout.GridData({span:"L1 M1 S1"})});var b=new sap.ui.core.Icon({src:"sap-icon://sys-add",decorative:false,tooltip:"Add"});b.addStyleClass("sapGreyCell");b.addStyleClass("sapUiSmallMarginEnd");h.addItem(b);var c=new sap.ui.core.Icon({src:"sap-icon://sys-cancel",decorative:false,press:fcg.mdg.editbp.handlers.ContactPersonCreate.removeWPForm,tooltip:"Cancel"});h.addItem(c);f.addContent(t);f.addContent(h);},removeWPForm:function(e){var f=e.getSource().getParent().getParent().getParent().getParent().getParent();var l=fcg.mdg.editbp.handlers.ContactPerson.oController.getView().byId("editLayout");fcg.mdg.editbp.handlers.ContactPerson.oController.oWizard.validateStep(fcg.mdg.editbp.handlers.ContactPerson.oController.getView().byId("editStep"));var a=f.getId().split("-")[1];var A=sap.ui.getCore().byId("INP-BP_ContactPersonWorkplacesRel-Addr_Num-"+a);var b=fcg.mdg.editbp.handlers.ContactPersonCreate.getIAVIndex(e);var c=fcg.mdg.editbp.handlers.ContactPersonCreate.aWpIds.indexOf(A.getSelectedKey());fcg.mdg.editbp.handlers.ContactPersonCreate.aWpIds.splice(c);if(A.getSelectedKey()!==undefined&&A.getSelectedKey()!==""){var o={};o.AD_ID=A.getSelectedKey();o.AD_ID__TXT=A.getSelectedItem().getText();fcg.mdg.editbp.handlers.ContactPerson.oWpAddressResults.results.push(o);}var d=sap.ui.getCore().byId(f.getId()+"--Form");var g=d.getFormContainers()[0];var h=g.getFormElements();for(var k=7;k<h.length;k++){var v=h[k].getFields()[0];if(v.getId().indexOf("__vbox")!==-1){var B=v.getItems()[0];var m=B.getContent()[3];if(m.getSelectedKey()!==undefined&&m.getSelectedKey()!==""){var n={};n.ADDR_VERS=m.getSelectedKey();n.ADDR_VERS__TXT=m.getSelectedItem().getText();fcg.mdg.editbp.handlers.ContactPerson.oWpIavResults.results[b].IAV.push(n);}}}for(var i=2;i<(l.getContent().length-1);i++){if(l.getContent()[i]===f){l.removeContent(l.getContent()[i]);break;}}if(fcg.mdg.editbp.handlers.ContactPersonChange.oController.vCurrentActionId==="changeRB"){var s;if(fcg.mdg.editbp.handlers.ContactPerson.oRelResults.BP_RelationsRel.results.length===1){s=0;}else{if(sap.ui.getCore().byId("selectDataListRBG")!==undefined){s=sap.ui.getCore().byId("selectDataListRBG").getSelectedIndex();}}var p={};var w=fcg.mdg.editbp.handlers.ContactPerson.oController;for(var k=0;k<fcg.mdg.editbp.handlers.ContactPersonChange.oController.changedArray.length;k++){if(fcg.mdg.editbp.handlers.ContactPersonChange.oController.changedArray[k].wpKey===a){fcg.mdg.editbp.handlers.ContactPersonChange.oController.changedArray.splice(k,1);k=k-1;}}if(a<fcg.mdg.editbp.handlers.ContactPersonChange.oWPResults.length){if(fcg.mdg.editbp.handlers.ContactPersonChange.oWPResults[a].action==="N"){fcg.mdg.editbp.handlers.ContactPersonChange.oWPResults.splice(a,1);}else{p.entity="BP_ContactPersonWorkplacesRel";p.currentEntityKey=a;p.wpKey=a;p.action="D";var V=fcg.mdg.editbp.handlers.ContactPerson.oRelResults.BP_RelationsRel.results[s].BP_RelationContactPersonRel.VALIDUNTILDATE;V=fcg.mdg.editbp.util.Formatter.validUntilDateFormat(V);p.currentkey="BP_WorkplaceAddressCollection(BP_GUID="+w.sItemPath+",PARTNER1=\'"+fcg.mdg.editbp.handlers.ContactPerson.oRelResults.BP_RelationsRel.results[s].BP_RelationContactPersonRel.PARTNER1+"\',PARTNER2=\'"+fcg.mdg.editbp.handlers.ContactPerson.oRelResults.BP_RelationsRel.results[s].BP_RelationContactPersonRel.PARTNER2+"\',RELATIONSHIPCATEGORY=\'"+fcg.mdg.editbp.handlers.ContactPerson.oRelResults.BP_RelationsRel.results[s].BP_RelationContactPersonRel.RELATIONSHIPCATEGORY+"\',ADDRESS_NUMBER=\'"+fcg.mdg.editbp.handlers.ContactPerson.oRelResults.BP_RelationsRel.results[s].BP_RelationContactPersonRel.BP_ContactPersonWorkplacesRel.results[a].ADDRESS_NUMBER+"\',VALIDUNTILDATE=datetime\'"+escape(V)+"\')";fcg.mdg.editbp.handlers.ContactPersonChange.oController.changedArray.push(p);}}}var q=fcg.mdg.editbp.handlers.ContactPerson.oController;var r=q.createdArray;for(var j=0;j<r.length;j++){if(r[j].wpKey===a){r.splice(j,1);j--;}}f.destroy();if(sap.ui.getCore().byId("toolWPAdd").hasListeners("press")===false){sap.ui.getCore().byId("toolWPAdd").attachPress(fcg.mdg.editbp.handlers.ContactPersonCreate.addWPAddress);sap.ui.getCore().byId("toolWPAdd").removeStyleClass("sapGreyCell");}},addNewTel:function(e){var w=fcg.mdg.editbp.handlers.ContactPerson.oController;var a=[];var f="";var b="";var c="";var g=fcg.mdg.editbp.handlers.ContactPerson.vIdCounterTel+1;if(e===undefined){c=fcg.mdg.editbp.handlers.ContactPerson.oWpFormId-1;var p=g-1;var d="SFWpAddressEdit-"+c+"--Form";var t="INP-BP_WorkplaceCommPhonesRel-TELEPHONE-"+"0-"+c;var F=sap.ui.getCore().byId(d);f=F.getFormContainers()[0];b=f.getFormElements().indexOf(sap.ui.getCore().byId(t).getParent())+1;}else{c=e.getSource().getParent().getParent().getParent().getParent().getParent().getId();c=c.split("-")[1];f=e.getSource().getParent().getParent().getParent();b=f.getFormElements().indexOf(e.getSource().getParent().getParent())+1;}if(fcg.mdg.editbp.handlers.ContactPersonChange.oController.vCurrentActionId==="changeRB"){var s;if(fcg.mdg.editbp.handlers.ContactPerson.oRelResults.BP_RelationsRel.results.length===1){s=0;}else{if(sap.ui.getCore().byId("selectDataListRBG")!==undefined){s=sap.ui.getCore().byId("selectDataListRBG").getSelectedIndex();}}var P=fcg.mdg.editbp.handlers.ContactPerson.oRelResults.BP_RelationsRel.results[s].PARTNER1;var C=[];C=fcg.mdg.editbp.handlers.ContactPerson.aAllCounters;for(var i=0;i<C.length;i++){if(C[i].formId===parseInt(c)&&C[i].cpId===P){C[i].telId=C[i].telId+1;g=C[i].telId;break;}}fcg.mdg.editbp.handlers.ContactPerson.aAllCounters=C;}fcg.mdg.editbp.handlers.ContactPerson.vIdCounterTel=g;var h=new sap.m.Input({id:"INP-BP_WorkplaceCommPhonesRel-COUNTRY-"+g+"-"+c,value:"{tel1>/COUNTRY}",maxLength:3,placeholder:w.i18nBundle.getText("CCITY"),valueHelpRequest:fcg.mdg.editbp.handlers.ContactPerson.onCPTelCountrykey,change:fcg.mdg.editbp.handlers.ContactPersonCreate.onTelCountryKeyChange,showValueHelp:true,layoutData:new sap.ui.layout.GridData({span:"L2 M2 S2",indent:"L3 M3 S3",linebreak:true})});var j=new sap.m.Input({id:"INP-BP_WorkplaceCommPhonesRel-TELEPHONE-"+g+"-"+c,value:"{tel1>/TELEPHONE}",maxLength:30,placeholder:w.i18nBundle.getText("Number"),change:fcg.mdg.editbp.handlers.ContactPersonCreate.onTelephoneChange,layoutData:new sap.ui.layout.GridData({span:"L2 M2 S2"})});var k=new sap.m.Input({id:"INP-BP_WorkplaceCommPhonesRel-EXTENSION-"+g+"-"+c,value:"{tel1>/EXTENSION}",maxLength:10,placeholder:w.i18nBundle.getText("Extension"),change:fcg.mdg.editbp.handlers.ContactPersonCreate.onExtensionChange,layoutData:new sap.ui.layout.GridData({span:"L1 M1 S1"})});var l=fcg.mdg.editbp.handlers.ContactPersonCreate.addIcons("Tel");a.push(h,j,k,l);var n=new sap.ui.layout.form.FormElement({fields:a});f.insertFormElement(n,b);fcg.mdg.editbp.handlers.ContactPerson.vNewTelField=n;var m=["INP-BP_WorkplaceCommPhonesRel-COUNTRY-"+g+"-"+c];fcg.mdg.editbp.handlers.ContactPersonCreate.setCountryKeyFields(c,m,w);},addNewMob:function(e){var w=fcg.mdg.editbp.handlers.ContactPerson.oController;var a=[];var f="";var b="";var c="";var g=fcg.mdg.editbp.handlers.ContactPerson.vIdCounterMob+1;if(e===undefined){c=fcg.mdg.editbp.handlers.ContactPerson.oWpFormId-1;var p=g-1;var d="SFWpAddressEdit-"+c+"--Form";var m="INP-BP_WorkplaceCommMobilesRel-TELEPHONE-"+"0-"+c;var F=sap.ui.getCore().byId(d);f=F.getFormContainers()[0];b=f.getFormElements().indexOf(sap.ui.getCore().byId(m).getParent())+1;}else{c=e.getSource().getParent().getParent().getParent().getParent().getParent().getId();c=c.split("-")[1];f=e.getSource().getParent().getParent().getParent();b=f.getFormElements().indexOf(e.getSource().getParent().getParent())+1;}if(fcg.mdg.editbp.handlers.ContactPersonChange.oController.vCurrentActionId==="changeRB"){var s;if(fcg.mdg.editbp.handlers.ContactPerson.oRelResults.BP_RelationsRel.results.length===1){s=0;}else{if(sap.ui.getCore().byId("selectDataListRBG")!==undefined){s=sap.ui.getCore().byId("selectDataListRBG").getSelectedIndex();}}var P=fcg.mdg.editbp.handlers.ContactPerson.oRelResults.BP_RelationsRel.results[s].PARTNER1;var C=[];C=fcg.mdg.editbp.handlers.ContactPerson.aAllCounters;for(var i=0;i<C.length;i++){if(C[i].formId===parseInt(c)&&C[i].cpId===P){C[i].mobId=C[i].mobId+1;g=C[i].mobId;break;}}fcg.mdg.editbp.handlers.ContactPerson.aAllCounters=C;}fcg.mdg.editbp.handlers.ContactPerson.vIdCounterMob=g;var h=new sap.m.Input({id:"INP-BP_WorkplaceCommMobilesRel-COUNTRY-"+g+"-"+c,value:"{/COUNTRY}",maxLength:3,placeholder:w.i18nBundle.getText("CCITY"),change:fcg.mdg.editbp.handlers.ContactPersonCreate.onMobCountryKeyChange,valueHelpRequest:fcg.mdg.editbp.handlers.ContactPerson.onCPMobCountrykey,showValueHelp:true,layoutData:new sap.ui.layout.GridData({span:"L2 M2 S2",indent:"L3 M3 S3",linebreak:true})});var j=new sap.m.Input({id:"INP-BP_WorkplaceCommMobilesRel-TELEPHONE-"+g+"-"+c,value:"{/TELEPHONE}",maxLength:30,placeholder:w.i18nBundle.getText("Number"),change:fcg.mdg.editbp.handlers.ContactPersonCreate.onMobChange,layoutData:new sap.ui.layout.GridData({span:"L3 M3 S3"})});var k=fcg.mdg.editbp.handlers.ContactPersonCreate.addIcons("Mob");a.push(h,j,k);var n=new sap.ui.layout.form.FormElement({fields:a});f.insertFormElement(n,b);fcg.mdg.editbp.handlers.ContactPerson.vNewMobField=n;var l=["INP-BP_WorkplaceCommMobilesRel-COUNTRY-"+g+"-"+c];fcg.mdg.editbp.handlers.ContactPersonCreate.setCountryKeyFields(c,l,w);},addNewFax:function(e){var w=fcg.mdg.editbp.handlers.ContactPerson.oController;var a=[];var f="";var b="";var c="";var g=fcg.mdg.editbp.handlers.ContactPerson.vIdCounterFax+1;if(e===undefined){c=fcg.mdg.editbp.handlers.ContactPerson.oWpFormId-1;var p=g-1;var d="SFWpAddressEdit-"+c+"--Form";var h="INP-BP_WorkplaceCommFaxesRel-FAX-"+"0-"+c;var F=sap.ui.getCore().byId(d);f=F.getFormContainers()[0];b=f.getFormElements().indexOf(sap.ui.getCore().byId(h).getParent())+1;}else{c=e.getSource().getParent().getParent().getParent().getParent().getParent().getId();c=c.split("-")[1];f=e.getSource().getParent().getParent().getParent();b=f.getFormElements().indexOf(e.getSource().getParent().getParent())+1;}if(fcg.mdg.editbp.handlers.ContactPersonChange.oController.vCurrentActionId==="changeRB"){var s;if(fcg.mdg.editbp.handlers.ContactPerson.oRelResults.BP_RelationsRel.results.length===1){s=0;}else{if(sap.ui.getCore().byId("selectDataListRBG")!==undefined){s=sap.ui.getCore().byId("selectDataListRBG").getSelectedIndex();}}var P=fcg.mdg.editbp.handlers.ContactPerson.oRelResults.BP_RelationsRel.results[s].PARTNER1;var C=[];C=fcg.mdg.editbp.handlers.ContactPerson.aAllCounters;for(var i=0;i<C.length;i++){if(C[i].formId===parseInt(c)&&C[i].cpId===P){C[i].faxId=C[i].faxId+1;g=C[i].faxId;break;}}fcg.mdg.editbp.handlers.ContactPerson.aAllCounters=C;}fcg.mdg.editbp.handlers.ContactPerson.vIdCounterFax=g;var j=new sap.m.Input({id:"INP-BP_WorkplaceCommFaxesRel-COUNTRY-"+g+"-"+c,value:"{/COUNTRY}",maxLength:3,placeholder:w.i18nBundle.getText("CCITY"),showValueHelp:true,valueHelpRequest:fcg.mdg.editbp.handlers.ContactPerson.onCPFaxCountrykey,change:fcg.mdg.editbp.handlers.ContactPersonCreate.onFaxCountryKeyChange,layoutData:new sap.ui.layout.GridData({span:"L2 M2 S2",indent:"L3 M3 S3",linebreak:true})});var k=new sap.m.Input({id:"INP-BP_WorkplaceCommFaxesRel-FAX-"+g+"-"+c,value:"{/FAX}",maxLength:30,placeholder:w.i18nBundle.getText("Number"),change:fcg.mdg.editbp.handlers.ContactPersonCreate.onFaxChange,layoutData:new sap.ui.layout.GridData({span:"L2 M2 S2"})});var l=new sap.m.Input({id:"INP-BP_WorkplaceCommFaxesRel-EXTENSION-"+g+"-"+c,value:"{/EXTENSION}",maxLength:10,placeholder:w.i18nBundle.getText("Extension"),change:fcg.mdg.editbp.handlers.ContactPersonCreate.onFaxExtensionChange,layoutData:new sap.ui.layout.GridData({span:"L1 M1 S1"})});var m=fcg.mdg.editbp.handlers.ContactPersonCreate.addIcons("Fax");a.push(j,k,l,m);var n=new sap.ui.layout.form.FormElement({fields:a});f.insertFormElement(n,b);fcg.mdg.editbp.handlers.ContactPerson.vNewFaxField=n;var o=["INP-BP_WorkplaceCommFaxesRel-COUNTRY-"+g+"-"+c];fcg.mdg.editbp.handlers.ContactPersonCreate.setCountryKeyFields(c,o,w);},addNewEmail:function(e){var a=[];var f="";var b="";var c="";var g=fcg.mdg.editbp.handlers.ContactPerson.vIdCounterEmail+1;if(e===undefined){c=fcg.mdg.editbp.handlers.ContactPerson.oWpFormId-1;var p=g-1;var d="SFWpAddressEdit-"+c+"--Form";var h="INP-BP_WorkplaceCommEMailsRel-E_MAIL-"+"0-"+c;var F=sap.ui.getCore().byId(d);f=F.getFormContainers()[0];b=f.getFormElements().indexOf(sap.ui.getCore().byId(h).getParent())+1;}else{c=e.getSource().getParent().getParent().getParent().getParent().getParent().getId();c=c.split("-")[1];f=e.getSource().getParent().getParent().getParent();b=f.getFormElements().indexOf(e.getSource().getParent().getParent())+1;}if(fcg.mdg.editbp.handlers.ContactPersonChange.oController.vCurrentActionId==="changeRB"){var s;if(fcg.mdg.editbp.handlers.ContactPerson.oRelResults.BP_RelationsRel.results.length===1){s=0;}else{if(sap.ui.getCore().byId("selectDataListRBG")!==undefined){s=sap.ui.getCore().byId("selectDataListRBG").getSelectedIndex();}}var P=fcg.mdg.editbp.handlers.ContactPerson.oRelResults.BP_RelationsRel.results[s].PARTNER1;var C=[];C=fcg.mdg.editbp.handlers.ContactPerson.aAllCounters;for(var i=0;i<C.length;i++){if(C[i].formId===parseInt(c)&&C[i].cpId===P){C[i].emailId=C[i].emailId+1;g=C[i].emailId;break;}}fcg.mdg.editbp.handlers.ContactPerson.aAllCounters=C;}fcg.mdg.editbp.handlers.ContactPerson.vIdCounterEmail=g;var j=new sap.m.Input({id:"INP-BP_WorkplaceCommEMailsRel-E_MAIL-"+g+"-"+c,value:"{/E_MAIL}",type:"Email",maxLength:241,change:fcg.mdg.editbp.handlers.ContactPersonCreate.onEMailChange,layoutData:new sap.ui.layout.GridData({span:"L5 M5 S5",indent:"L3 M3 S3",linebreak:true})});var k=fcg.mdg.editbp.handlers.ContactPersonCreate.addIcons("Email");a.push(j,k);var n=new sap.ui.layout.form.FormElement({fields:a});f.insertFormElement(n,b);fcg.mdg.editbp.handlers.ContactPerson.vNewEmailField=n;},removeFormElement:function(e){var w=fcg.mdg.editbp.handlers.ContactPerson.oController;var a;var d={};var f=e.getSource().getParent().getParent().getParent();var b=e.getSource().getParent().getParent();var c=e.getSource().getId();var W=b.getFields()[0].getId().split("-")[4];var I=b.getFields()[0].getId().split("-")[3];fcg.mdg.editbp.handlers.ContactPerson.oController.oWizard.validateStep(fcg.mdg.editbp.handlers.ContactPerson.oController.getView().byId("editStep"));if(fcg.mdg.editbp.handlers.ContactPersonChange.oController.vCurrentActionId==="changeRB"){d.entity=b.getFields()[0].getId().split("-")[1];var g="INP-BP_ContactPersonWorkplacesRel-Addr_Num-"+W;var h=sap.ui.getCore().byId(g).getSelectedKey();for(var m=0;m<fcg.mdg.editbp.handlers.ContactPersonChange.oWPResults.length;m++){if(fcg.mdg.editbp.handlers.ContactPersonChange.oWPResults[m].ADDRESS_NUMBER===h){a=m;break;}}d.addrIndex=a;if(d.entity==='BP_WorkplaceCommPhonesRel'||d.entity==='BP_WorkplaceCommMobilesRel'||d.entity==='BP_WorkplaceCommFaxesRel'||d.entity==='BP_WorkplaceCommEMailsRel'){if(a!==undefined){switch(b.getFields()[0].getId().split("-")[1]){case'BP_WorkplaceCommPhonesRel':if(b.getFields()[0].getId().split("-")[3]<fcg.mdg.editbp.handlers.ContactPersonChange.oWPResults[a].BP_WorkplaceCommPhonesRel.results.length){if(fcg.mdg.editbp.handlers.ContactPersonChange.oWPResults[a].BP_WorkplaceCommPhonesRel.results[I].action===undefined){d.action="D";}else if(fcg.mdg.editbp.handlers.ContactPersonChange.oWPResults[a].BP_WorkplaceCommPhonesRel.results[I].action==="N"){fcg.mdg.editbp.handlers.ContactPersonChange.oWPResults[a].BP_WorkplaceCommPhonesRel.results.splice(I,1);}}break;case'BP_WorkplaceCommMobilesRel':if(b.getFields()[0].getId().split("-")[3]<fcg.mdg.editbp.handlers.ContactPersonChange.oWPResults[a].BP_WorkplaceCommMobilesRel.results.length){if(fcg.mdg.editbp.handlers.ContactPersonChange.oWPResults[a].BP_WorkplaceCommMobilesRel.results[I].action===undefined){d.action="D";}else if(fcg.mdg.editbp.handlers.ContactPersonChange.oWPResults[a].BP_WorkplaceCommMobilesRel.results[I].action==="N"){fcg.mdg.editbp.handlers.ContactPersonChange.oWPResults[a].BP_WorkplaceCommMobilesRel.results.splice(I,1);}}break;case'BP_WorkplaceCommFaxesRel':if(b.getFields()[0].getId().split("-")[3]<fcg.mdg.editbp.handlers.ContactPersonChange.oWPResults[a].BP_WorkplaceCommFaxesRel.results.length){if(fcg.mdg.editbp.handlers.ContactPersonChange.oWPResults[a].BP_WorkplaceCommFaxesRel.results[I].action===undefined){d.action="D";}else if(fcg.mdg.editbp.handlers.ContactPersonChange.oWPResults[a].BP_WorkplaceCommFaxesRel.results[I].action==="N"){fcg.mdg.editbp.handlers.ContactPersonChange.oWPResults[a].BP_WorkplaceCommFaxesRel.results.splice(I,1);}}break;case'BP_WorkplaceCommEMailsRel':if(b.getFields()[0].getId().split("-")[3]<fcg.mdg.editbp.handlers.ContactPersonChange.oWPResults[a].BP_WorkplaceCommEMailsRel.results.length){if(fcg.mdg.editbp.handlers.ContactPersonChange.oWPResults[a].BP_WorkplaceCommEMailsRel.results[I].action===undefined){d.action="D";}else if(fcg.mdg.editbp.handlers.ContactPersonChange.oWPResults[a].BP_WorkplaceCommEMailsRel.results[I].action==="N"){fcg.mdg.editbp.handlers.ContactPersonChange.oWPResults[a].BP_WorkplaceCommEMailsRel.results.splice(I,1);}}break;}}for(var i=0;i<fcg.mdg.editbp.handlers.ContactPersonChange.oController.changedArray.length;i++){for(var j=0;j<b.getFields().length;j++){if(fcg.mdg.editbp.handlers.ContactPersonChange.oController.changedArray[i].entity===b.getFields()[j].getId().split("-")[1]&&(fcg.mdg.editbp.handlers.ContactPersonChange.oController.changedArray[i].createdIndex===b.getFields()[j].getId().split("-")[3]||fcg.mdg.editbp.handlers.ContactPersonChange.oController.changedArray[i].currentEntityKey===b.getFields()[j].getId().split("-")[3])&&fcg.mdg.editbp.handlers.ContactPersonChange.oController.changedArray[i].wpKey===b.getFields()[j].getId().split("-")[4]&&fcg.mdg.editbp.handlers.ContactPersonChange.oController.changedArray[i].field===b.getFields()[j].getId().split("-")[2]){fcg.mdg.editbp.handlers.ContactPersonChange.oController.changedArray.splice(i,1);i=i-1;break;}}}if(d.action==="D"){d.createdIndex=b.getFields()[0].getId().split("-")[3];d.currentEntityKey=b.getFields()[0].getId().split("-")[3];d.wpKey=b.getFields()[0].getId().split("-")[4];var v=fcg.mdg.editbp.handlers.ContactPersonChange.oWPResults[(a)].VALIDUNTILDATE;v=fcg.mdg.editbp.util.Formatter.validUntilDateFormat(v);d.currentkey="(BP_GUID="+w.sItemPath+",PARTNER1=\'"+fcg.mdg.editbp.handlers.ContactPersonChange.oWPResults[(a)].PARTNER1+"\',PARTNER2=\'"+fcg.mdg.editbp.handlers.ContactPersonChange.oWPResults[(a)].PARTNER2+"\',RELATIONSHIPCATEGORY=\'"+fcg.mdg.editbp.handlers.ContactPersonChange.oWPResults[(a)].RELATIONSHIPCATEGORY+"\',ADDRESS_NUMBER=\'"+fcg.mdg.editbp.handlers.ContactPersonChange.oWPResults[(a)].ADDRESS_NUMBER+"\',COMM_TYPE=\'"+fcg.mdg.editbp.util.DataAccess.getDataFromPath(fcg.mdg.editbp.handlers.ContactPersonChange.oWPResults[(a)],d.entity+"/results/"+I+"/COMM_TYPE")+"\',CONSNUMBER=\'"+fcg.mdg.editbp.util.DataAccess.getDataFromPath(fcg.mdg.editbp.handlers.ContactPersonChange.oWPResults[(a)],d.entity+"/results/"+I+"/CONSNUMBER")+"\',VALIDUNTILDATE=datetime\'"+escape(v)+"\')";fcg.mdg.editbp.handlers.ContactPersonChange.oController.changedArray.push(d);}}}if(c.indexOf("telCPCancel")!==-1||c.indexOf("faxCPCancel")!==-1||c.indexOf("mobCPCancel")!==-1||c.indexOf("emailCPCancel")!==-1){for(var k=0;k<(b.getFields().length-1);k++){var l=b.getFields()[k];if(l.getValue()!==""){l.setValueState("None");l.setValue("");}}}else{b.destroyFields();f.removeFormElement(b.getId());}if(e.getSource().getId().split("-")[0]==="telCPCancel"||e.getSource().getId().split("-")[0]==="faxCPCancel"||e.getSource().getId().split("-")[0]==="mobCPCancel"||e.getSource().getId().split("-")[0]==="emailCPCancel"){var g=b.getFields()[0].getId();fcg.mdg.editbp.handlers.ContactPersonCreate.disableEnableIcon(g,fcg.mdg.editbp.handlers.ContactPersonCreate.removeFormElement);}},onTelCountryKeyChange:function(e){var t=e.getParameters().id;var i=t;t=sap.ui.getCore().byId(t);var c=t.getValue().toUpperCase();t.setValue(c);fcg.mdg.editbp.handlers.ContactPersonCreate.CountryKey(e,t);if(i.split("-")[3]==="0"){fcg.mdg.editbp.handlers.ContactPersonCreate.disableEnableIcon(i,fcg.mdg.editbp.handlers.ContactPersonCreate.removeFormElement);}},disableEnableIcon:function(i,m){var e=i.split('-')[1];var a;switch(e){case"BP_WorkplaceCommPhonesRel":a="telCPCancel-"+(i.split('-')[4]);if(sap.ui.getCore().byId("INP-BP_WorkplaceCommPhonesRel-COUNTRY-0-"+(i.split('-')[4])).getValue()===""&&sap.ui.getCore().byId("INP-BP_WorkplaceCommPhonesRel-TELEPHONE-0-"+(i.split('-')[4])).getValue()===""&&sap.ui.getCore().byId("INP-BP_WorkplaceCommPhonesRel-EXTENSION-0-"+(i.split('-')[4])).getValue()===""){if(sap.ui.getCore().byId(a).hasListeners("press")===true){sap.ui.getCore().byId(a).detachEvent("press");sap.ui.getCore().byId(a).detachPress(m);sap.ui.getCore().byId(a).addStyleClass("sapGreyCell");}}else{if(sap.ui.getCore().byId(a).hasListeners("press")===false){sap.ui.getCore().byId(a).attachPress(m);sap.ui.getCore().byId(a).removeStyleClass("sapGreyCell");}}break;case"BP_WorkplaceCommMobilesRel":a="mobCPCancel-"+(i.split('-')[4]);if(sap.ui.getCore().byId("INP-BP_WorkplaceCommMobilesRel-COUNTRY-0-"+(i.split('-')[4])).getValue()===""&&sap.ui.getCore().byId("INP-BP_WorkplaceCommMobilesRel-TELEPHONE-0-"+(i.split('-')[4])).getValue()===""){if(sap.ui.getCore().byId(a).hasListeners("press")===true){sap.ui.getCore().byId(a).detachEvent("press");sap.ui.getCore().byId(a).detachPress(m);sap.ui.getCore().byId(a).addStyleClass("sapGreyCell");}}else{if(sap.ui.getCore().byId(a).hasListeners("press")===false){sap.ui.getCore().byId(a).attachPress(m);sap.ui.getCore().byId(a).removeStyleClass("sapGreyCell");}}break;case"BP_WorkplaceCommFaxesRel":a="faxCPCancel-"+(i.split('-')[4]);if(sap.ui.getCore().byId("INP-BP_WorkplaceCommFaxesRel-COUNTRY-0-"+(i.split('-')[4])).getValue()===""&&sap.ui.getCore().byId("INP-BP_WorkplaceCommFaxesRel-FAX-0-"+(i.split('-')[4])).getValue()===""&&sap.ui.getCore().byId("INP-BP_WorkplaceCommFaxesRel-EXTENSION-0-"+(i.split('-')[4])).getValue()===""){if(sap.ui.getCore().byId(a).hasListeners("press")===true){sap.ui.getCore().byId(a).detachEvent("press");sap.ui.getCore().byId(a).detachPress(m);sap.ui.getCore().byId(a).addStyleClass("sapGreyCell");}}else{if(sap.ui.getCore().byId(a).hasListeners("press")===false){sap.ui.getCore().byId(a).attachPress(m);sap.ui.getCore().byId(a).removeStyleClass("sapGreyCell");}}break;case"BP_WorkplaceCommEMailsRel":a="emailCPCancel-"+(i.split('-')[4]);if(sap.ui.getCore().byId("INP-BP_WorkplaceCommEMailsRel-E_MAIL-0-"+(i.split('-')[4])).getValue()===""){if(sap.ui.getCore().byId(a).hasListeners("press")===true){sap.ui.getCore().byId(a).detachEvent("press");sap.ui.getCore().byId(a).detachPress(m);sap.ui.getCore().byId(a).addStyleClass("sapGreyCell");}}else{if(sap.ui.getCore().byId(a).hasListeners("press")===false){sap.ui.getCore().byId(a).attachPress(m);sap.ui.getCore().byId(a).removeStyleClass("sapGreyCell");}}break;}},onMobCountryKeyChange:function(e){var m=e.getParameters().id;var i=m;m=sap.ui.getCore().byId(m);var c=m.getValue().toUpperCase();m.setValue(c);fcg.mdg.editbp.handlers.ContactPersonCreate.CountryKey(e,m);if(i.split("-")[3]==="0"){fcg.mdg.editbp.handlers.ContactPersonCreate.disableEnableIcon(i,fcg.mdg.editbp.handlers.ContactPersonCreate.removeFormElement);}},onFaxCountryKeyChange:function(e){var f=e.getParameters().id;var i=f;f=sap.ui.getCore().byId(f);var c=f.getValue().toUpperCase();f.setValue(c);fcg.mdg.editbp.handlers.ContactPersonCreate.CountryKey(e,f);if(i.split("-")[3]==="0"){fcg.mdg.editbp.handlers.ContactPersonCreate.disableEnableIcon(i,fcg.mdg.editbp.handlers.ContactPersonCreate.removeFormElement);}},CountryKey:function(e,f){this.ChangeDeferred=jQuery.Deferred();f.attachEventOnce("change",function(){},this);var t=this;var c=f.getValue();var a=c.replace(/^[ ]+|[ ]+$/g,'');var C=fcg.mdg.editbp.handlers.ContactPerson.oController;var b=C.i18nBundle;var o=fcg.mdg.editbp.util.DataAccess.getValueHelpData()[5].data;var d=e.getParameters().id;var g=d.split("-")[3];var w=d.split("-")[4];var h="",j="";if(d.indexOf("INP-BP_WorkplaceCommPhonesRel")!==-1){h=sap.ui.getCore().byId("INP-BP_WorkplaceCommPhonesRel-TELEPHONE-"+g+"-"+w).getValue();j=sap.ui.getCore().byId("INP-BP_WorkplaceCommPhonesRel-EXTENSION-"+g+"-"+w).getValue();}else if(d.indexOf("INP-BP_WorkplaceCommFaxesRel")!==-1){h=sap.ui.getCore().byId("INP-BP_WorkplaceCommFaxesRel-FAX-"+g+"-"+w).getValue();j=sap.ui.getCore().byId("INP-BP_WorkplaceCommFaxesRel-EXTENSION-"+g+"-"+w).getValue();}else{h=sap.ui.getCore().byId("INP-BP_WorkplaceCommMobilesRel-TELEPHONE-"+g+"-"+w).getValue();}if(a!==""){var l=false;for(var i=0;i<o.results.length;i++){if(o.results[i].KEY===a){if(c!==""){f.setValueState("None");f.setValueStateText("");if(h!==""||j!==""){fcg.mdg.editbp.handlers.ContactPerson.oController.onChange(e);}}l=true;break;}}if(l===false){this.countryError=true;f.setValueState("Error");var k=b.getText("PLACEHOLDER_COUNTRY_KEY")+" "+f.getValue()+" "+b.getText("NO_EXISTENCE");f.setValueStateText(k);}}else{var m=sap.ui.getCore().byId("INP-BP_WorkplaceCommPhonesRel-TELEPHONE-"+g+"-"+w);var n=sap.ui.getCore().byId("INP-BP_WorkplaceCommPhonesRel-EXTENSION-"+g+"-"+w);var p=sap.ui.getCore().byId("INP-BP_WorkplaceCommMobilesRel-TELEPHONE-"+g+"-"+w);var q=sap.ui.getCore().byId("INP-BP_WorkplaceCommFaxesRel-FAX-"+g+"-"+w);var r=sap.ui.getCore().byId("INP-BP_WorkplaceCommFaxesRel-EXTENSION-"+g+"-"+w);if(f.getId().indexOf("INP-BP_WorkplaceCommPhonesRel-COUNTRY")>-1&&(m.getValue()!==""||n.getValue()!=="")){f.setValueState("Error");f.setValueStateText(b.getText("COUNTRY_CHECK"));}else if(f.getId().indexOf("INP-BP_WorkplaceCommMobilesRel-COUNTRY")>-1&&p.getValue()!==""){f.setValueState("Error");f.setValueStateText(b.getText("COUNTRY_CHECK"));}else if(f.getId().indexOf("INP-BP_WorkplaceCommFaxesRel-COUNTRY")>-1&&(q.getValue()!==""||r.getValue()!=="")){f.setValueState("Error");f.setValueStateText(b.getText("COUNTRY_CHECK"));}else{f.setValue(a);f.setValueStateText("");f.setValueState("None");}t.ChangeDeferred.resolve();}},onTelephoneChange:function(e){var c=fcg.mdg.editbp.handlers.ContactPerson.oController;var i=c.i18nBundle;var t=e.getParameters().id;var a=t;var b=sap.ui.getCore().byId("INP-BP_WorkplaceCommPhonesRel-COUNTRY-"+t.split('-')[3]+"-"+t.split('-')[4]);var d=sap.ui.getCore().byId("INP-BP_WorkplaceCommPhonesRel-EXTENSION-"+t.split('-')[3]+"-"+t.split('-')[4]);t=sap.ui.getCore().byId(t);var f=t.getValue();var s=f.replace(/^[ ]+|[ ]+$/g,'');t.setValue(s);t.setValueState("None");var g=fcg.mdg.editbp.handlers.ContactPersonCreate._checkNumber(s);if(g===false){t.setValueState("Error");return;}var h=d.getValue().trim();var l=s.length+h.length;if(l>24){t.setValueState("Error");t.setValueStateText(i.getText("NUM_LENGTH"));}if(s!==""||h!==""){if(b.getValue()===""){b.setValueState("Error");b.setValueStateText(i.getText("COUNTRY_CHECK"));}else{if(i.getText("COUNTRY_CHECK")===b.getValueStateText()){b.setValueState("None");b.setValueStateText("");}}}else{if(i.getText("COUNTRY_CHECK")===b.getValueStateText()){b.setValueState("None");b.setValueStateText("");}}if(a.split("-")[3]==="0"){fcg.mdg.editbp.handlers.ContactPersonCreate.disableEnableIcon(a,fcg.mdg.editbp.handlers.ContactPersonCreate.removeFormElement);}b.fireEvent("change");fcg.mdg.editbp.handlers.ContactPerson.oController.onChange(e);},onExtensionChange:function(e){var c=fcg.mdg.editbp.handlers.ContactPerson.oController;var i=c.i18nBundle;var t=e.getParameters().id;var a=t;var b=sap.ui.getCore().byId("INP-BP_WorkplaceCommPhonesRel-COUNTRY-"+t.split('-')[3]+"-"+t.split('-')[4]);var d=sap.ui.getCore().byId("INP-BP_WorkplaceCommPhonesRel-TELEPHONE-"+t.split('-')[3]+"-"+t.split('-')[4]);t=sap.ui.getCore().byId(t);var f=t.getValue().trim();var s=f.replace(/^[ ]+|[ ]+$/g,'');t.setValue(s);t.setValueState("None");var g=fcg.mdg.editbp.handlers.ContactPersonCreate._checkNumber(s);if(g===false){t.setValueState("Error");return;}var h=d.getValue();var l=h.length+s.length;if(l>24){t.setValueState("Error");t.setValueStateText(i.getText("NUM_LENGTH"));}if(h!==""||s!==""){if(b.getValue()===""){b.setValueState("Error");b.setValueStateText(i.getText("COUNTRY_CHECK"));}else{if(i.getText("COUNTRY_CHECK")===b.getValueStateText()){b.setValueState("None");b.setValueStateText("");}}}else{if(i.getText("COUNTRY_CHECK")===b.getValueStateText()){b.setValueState("None");b.setValueStateText("");}}if(a.split("-")[3]==="0"){fcg.mdg.editbp.handlers.ContactPersonCreate.disableEnableIcon(a,fcg.mdg.editbp.handlers.ContactPersonCreate.removeFormElement);}fcg.mdg.editbp.handlers.ContactPerson.oController.onChange(e);},onFaxChange:function(e){var c=fcg.mdg.editbp.handlers.ContactPerson.oController;var i=c.i18nBundle;var f=e.getParameters().id;var a=f;var b=sap.ui.getCore().byId("INP-BP_WorkplaceCommFaxesRel-COUNTRY-"+f.split('-')[3]+"-"+f.split('-')[4]);var d=sap.ui.getCore().byId("INP-BP_WorkplaceCommFaxesRel-EXTENSION-"+f.split('-')[3]+"-"+f.split('-')[4]);f=sap.ui.getCore().byId(f);var g=f.getValue().trim();var s=g.replace(/^[ ]+|[ ]+$/g,'');f.setValue(s);f.setValueState("None");var h=fcg.mdg.editbp.handlers.ContactPersonCreate._checkNumber(s);if(h===false){f.setValueState("Error");return;}var j=d.getValue();var l=s.length+j.length;if(l>24){f.setValueState("Error");f.setValueStateText(i.getText("FAX_NUM_LENGTH"));}if(s!==""||j!==""){if(b.getValue()===""){b.setValueState("Error");b.setValueStateText(i.getText("COUNTRY_CHECK"));}else{if(i.getText("COUNTRY_CHECK")===b.getValueStateText()){b.setValueState("None");b.setValueStateText("");}}}else{if(i.getText("COUNTRY_CHECK")===b.getValueStateText()){b.setValueState("None");b.setValueStateText("");}}if(a.split("-")[3]==="0"){fcg.mdg.editbp.handlers.ContactPersonCreate.disableEnableIcon(a,fcg.mdg.editbp.handlers.ContactPersonCreate.removeFormElement);}b.fireEvent("change");fcg.mdg.editbp.handlers.ContactPerson.oController.onChange(e);},onFaxExtensionChange:function(e){var c=fcg.mdg.editbp.handlers.ContactPerson.oController;var i=c.i18nBundle;var f=e.getParameters().id;var a=f;var b=sap.ui.getCore().byId("INP-BP_WorkplaceCommFaxesRel-COUNTRY-"+f.split('-')[3]+"-"+f.split('-')[4]);var d=sap.ui.getCore().byId("INP-BP_WorkplaceCommFaxesRel-FAX-"+f.split('-')[3]+"-"+f.split('-')[4]);f=sap.ui.getCore().byId(f);var g=f.getValue().trim();var s=g.replace(/^[ ]+|[ ]+$/g,'');f.setValue(s);f.setValueState("None");var h=fcg.mdg.editbp.handlers.ContactPersonCreate._checkNumber(s);if(h===false){f.setValueState("Error");return;}var j=d.getValue();var l=j.length+s.length;if(l>24){f.setValueState("Error");f.setValueStateText(i.getText("FAX_NUM_LENGTH"));return;}if(j!==""||s!==""){if(b.getValue()===""){b.setValueState("Error");b.setValueStateText(i.getText("COUNTRY_CHECK"));}else{if(i.getText("COUNTRY_CHECK")===b.getValueStateText()){b.setValueState("None");b.setValueStateText("");}}}else{if(i.getText("COUNTRY_CHECK")===b.getValueStateText()){b.setValueState("None");b.setValueStateText("");}}if(a.split("-")[3]==="0"){fcg.mdg.editbp.handlers.ContactPersonCreate.disableEnableIcon(a,fcg.mdg.editbp.handlers.ContactPersonCreate.removeFormElement);}fcg.mdg.editbp.handlers.ContactPerson.oController.onChange(e);},onMobChange:function(e){var c=fcg.mdg.editbp.handlers.ContactPerson.oController;var i=c.i18nBundle;var m=e.getParameters().id;var a=m;var b=sap.ui.getCore().byId("INP-BP_WorkplaceCommMobilesRel-COUNTRY-"+m.split('-')[3]+"-"+m.split('-')[4]);m=sap.ui.getCore().byId(m);var d=m.getValue().trim();var s=d.replace(/^[ ]+|[ ]+$/g,'');m.setValue(s);m.setValueState("None");var f=fcg.mdg.editbp.handlers.ContactPersonCreate._checkNumber(s);if(f===false||s.length>24){m.setValueState("Error");return;}if(d!==""){if(b.getValue()===""){b.setValueState("Error");b.setValueStateText(i.getText("COUNTRY_CHECK"));}else{if(i.getText("COUNTRY_CHECK")===b.getValueStateText()){b.setValueState("None");b.setValueStateText("");}}}else{if(i.getText("COUNTRY_CHECK")===b.getValueStateText()){b.setValueState("None");b.setValueStateText("");}}if(a.split("-")[3]==="0"){fcg.mdg.editbp.handlers.ContactPersonCreate.disableEnableIcon(a,fcg.mdg.editbp.handlers.ContactPersonCreate.removeFormElement);}b.fireEvent("change");fcg.mdg.editbp.handlers.ContactPerson.oController.onChange(e);},onEMailChange:function(e){var c=fcg.mdg.editbp.handlers.ContactPerson.oController;var i=c.i18nBundle;var a=e.getParameters().id;var b=a;a=sap.ui.getCore().byId(a);var d=a.getValue();if(d.replace(/^[ ]+|[ ]+$/g,'')===""){a.setValue("");}if(a.getValue()!==""){var E=fcg.mdg.editbp.handlers.ContactPersonCreate._checkEmail(d);if(E===false){a.setValueState("Error");a.setValueStateText(i.getText("EMAIL_CHECK"));}else{a.setValueState("None");a.setValueStateText();}}else{a.setValueState("None");a.setValueStateText();}if(b.split("-")[3]==="0"){fcg.mdg.editbp.handlers.ContactPersonCreate.disableEnableIcon(b,fcg.mdg.editbp.handlers.ContactPersonCreate.removeFormElement);}fcg.mdg.editbp.handlers.ContactPerson.oController.onChange(e);},_checkEmail:function(e){var f=/^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/;if(!f.test(e)){return false;}},_checkNumber:function(n){var f=/[^a-zA-Z0-9#\*\(\)\-,\s\/+]/;if(f.test(n)){return false;}},addNewIAV:function(e){var l=fcg.mdg.editbp.handlers.ContactPersonCreate;if(l.oExistingIav===""){l.oWPIavModel="";}var w=fcg.mdg.editbp.handlers.ContactPerson.oController;var a=[];var f="";var b="";var c="";var d=fcg.mdg.editbp.handlers.ContactPerson.oIavFormId;if(e!==undefined){f=e.getSource().getParent().getParent().getParent();b=f.getFormElements().indexOf(e.getSource().getParent().getParent());c=e.getSource().getParent().getParent().getParent().getParent().getParent().getId();c=c.split("-")[1];}else{c=fcg.mdg.editbp.handlers.ContactPerson.oWpFormId-1;var g="SFWpAddressEdit-"+c+"--Form";var F=sap.ui.getCore().byId(g);f=F.getFormContainers()[0];b=b=f.getFormElements().length;}var p=sap.ui.getCore().byId("INP-BP_WorkplaceIntAddressVersRel-ADDR_VERS-"+(d-1)+"-"+c);if(p!==undefined&&p.getSelectedKey()===""){return;}var i=fcg.mdg.editbp.handlers.ContactPersonCreate.getIAVIndex(e);if(fcg.mdg.editbp.handlers.ContactPerson.oWpIavResults.results[i].IAV.length<1){return;}fcg.mdg.editbp.handlers.ContactPerson.oIavFormId=d+1;var n=new sap.ui.layout.form.SimpleForm({id:"SFIAVPersonForCPEdit-"+d+"-"+c,maxContainerCols:1,minWidth:1024,layout:"ResponsiveGridLayout",labelSpanL:3,labelSpanM:3,emptySpanL:4,emptySpanS:4,emptySpanM:4,labelSpanS:3,editable:true,"class":"paddingFixSF"});fcg.mdg.editbp.handlers.ContactPersonCreate.addIavToolBar(n,w);var h=new sap.m.Label({text:w.i18nBundle.getText("ADDRESSVERSION")});n.addContent(h);var j=new sap.m.Select({id:"INP-BP_WorkplaceIntAddressVersRel-ADDR_VERS-"+d+"-"+c,change:fcg.mdg.editbp.handlers.ContactPersonCreate.onIavAddressChange});var D=w.i18nBundle.getText("NONE");var t=new sap.ui.model.json.JSONModel();var k=fcg.mdg.editbp.handlers.ContactPerson.getWPIavArray();t.setData(k.results[i]);var m=new sap.ui.core.Item({key:"{ADDR_VERS}",text:"{ADDR_VERS__TXT}"});j.setModel(t);j.bindItems("/IAV",m);if(k.results[i].IAV.length>1){var o=new sap.ui.core.Item({key:"",text:D});j.addItem(o);j.setSelectedKey();}else{j.setSelectedItem(j.getItems()[0]);}n.addContent(j);var q=new sap.m.Label({text:w.i18nBundle.getText("N1")});var r=new sap.m.Select({id:"INP-BP_WorkplaceIntPersVersionRel-TITLE-"+d+"-"+c,change:fcg.mdg.editbp.handlers.ContactPerson.onChange_Create,enabled:false});fcg.mdg.editbp.handlers.ContactPersonCreate.setvHelpTitle(q,r);n.addContent(q);n.addContent(r);var s=new sap.m.Input({id:"INP-BP_WorkplaceIntPersVersionRel-FIRSTNAME-"+d+"-"+c,value:"{WpIavPers>/FIRSTNAME}",maxLength:30,change:fcg.mdg.editbp.handlers.ContactPerson.onChange_Create,enabled:false});n.addContent(s);var u=new sap.m.Label({text:w.i18nBundle.getText("L_Name")});n.addContent(u);var v=new sap.m.Input({id:"INP-BP_WorkplaceIntPersVersionRel-LASTNAME-"+d+"-"+c,value:"{WpIavPers>/LASTNAME}",maxLength:30,change:fcg.mdg.editbp.handlers.ContactPerson.onChange_Create,enabled:false});n.addContent(v);var x=new sap.m.Label({text:w.i18nBundle.getText("DEPARTMENT")});n.addContent(x);var y=new sap.m.Input({id:"INP-BP_WorkplaceIntAddressVersRel-Department-"+d+"-"+c,value:"{wpIav>/DEPARTMENT}",maxLength:40,change:fcg.mdg.editbp.handlers.ContactPerson.onChange_Create,enabled:false});n.addContent(y);var z=new sap.m.Label({text:w.i18nBundle.getText("FUNCTION")});n.addContent(z);var A=new sap.m.Input({id:"INP-BP_WorkplaceIntAddressVersRel-Function-"+d+"-"+c,value:"{wpIav>/FUNCTION}",maxLength:40,change:fcg.mdg.editbp.handlers.ContactPerson.onChange_Create,enabled:false});n.addContent(A);var B=new sap.m.VBox({layoutData:new sap.ui.layout.GridData({span:"L12 M12 S12",linebreak:true})});B.addItem(n);a.push(B);var C=new sap.ui.layout.form.FormElement({fields:a});f.insertFormElement(C,b);fcg.mdg.editbp.handlers.ContactPerson.oIavNewForm=n;if(k.results[i].IAV.length===1){sap.ui.getCore().byId("INP-BP_WorkplaceIntAddressVersRel-ADDR_VERS-"+d+"-"+c).fireEvent('change');sap.ui.getCore().byId("INP-BP_WorkplaceIntAddressVersRel-ADDR_VERS-"+d+"-"+c).setEnabled(false);}if(sap.ui.getCore().byId("toolWPIavAdd-"+c).hasListeners("press")===true){sap.ui.getCore().byId("toolWPIavAdd-"+c).detachEvent("press");sap.ui.getCore().byId("toolWPIavAdd-"+c).detachPress(fcg.mdg.editbp.handlers.ContactPersonCreate.addNewIAV);sap.ui.getCore().byId("toolWPIavAdd-"+c).addStyleClass("sapGreyCell");}if(l.oExistingIav==="X"){var P=new sap.ui.model.json.JSONModel();P.setData(l.oWPIavModel.getData().BP_WorkplaceIntPersVersionRel);sap.ui.getCore().byId("INP-BP_WorkplaceIntAddressVersRel-ADDR_VERS-"+d+"-"+c).setSelectedKey(l.oWPIavModel.getData().ADDR_VERS);sap.ui.getCore().byId("INP-BP_WorkplaceIntAddressVersRel-ADDR_VERS-"+d+"-"+c).fireEvent("change");sap.ui.getCore().byId("SFIAVPersonForCPEdit-"+d+"-"+c).setModel(l.oWPIavModel,"wpIav");sap.ui.getCore().byId("SFIAVPersonForCPEdit-"+d+"-"+c).setModel(P,"WpIavPers");sap.ui.getCore().byId("INP-BP_WorkplaceIntPersVersionRel-TITLE-"+d+"-"+c).setSelectedKey(l.oWPIavModel.getData().BP_WorkplaceIntPersVersionRel.TITLE_P);l.oExistingIav="";}},removeIavForm:function(e){var w=fcg.mdg.editbp.handlers.ContactPerson.oController;var f=e.getSource().getParent().getParent().getParent().getParent().getParent().getId();var v=sap.ui.getCore().byId(f).getParent();var a=v.getParent().getParent().getParent().getParent().getId();var b=a.split("-")[1];a=sap.ui.getCore().byId(a+"--Form");var c=f.split("-")[1];var A=sap.ui.getCore().byId("INP-BP_WorkplaceIntAddressVersRel-ADDR_VERS-"+c+"-"+b);var d=fcg.mdg.editbp.handlers.ContactPersonCreate.getIAVIndex(e);fcg.mdg.editbp.handlers.ContactPerson.oController.oWizard.validateStep(fcg.mdg.editbp.handlers.ContactPerson.oController.getView().byId("editStep"));if(A.getSelectedKey()!==undefined&&A.getSelectedKey()!==""){var o={};o.ADDR_VERS=A.getSelectedKey();o.ADDR_VERS__TXT=A.getSelectedItem().getText();fcg.mdg.editbp.handlers.ContactPerson.oWpIavResults.results[d].IAV.push(o);}if(fcg.mdg.editbp.handlers.ContactPerson.oController.vCurrentActionId==="createRB"){var g=fcg.mdg.editbp.handlers.ContactPerson.oController.createdArray;for(var j=0;j<g.length;j++){if(g[j].wpKey===b&&g[j].currentEntityKey===c&&(g[j].entity==="BP_WorkplaceIntPersVersionRel"||g[j].entity==="BP_WorkplaceIntAddressVersRel")){g.splice(j,1);j--;}}}if(fcg.mdg.editbp.handlers.ContactPersonChange.oController.vCurrentActionId==="changeRB"){var h={};for(var i=0;i<fcg.mdg.editbp.handlers.ContactPersonChange.oController.changedArray.length;i++){if(fcg.mdg.editbp.handlers.ContactPersonChange.oController.changedArray[i].wpKey===b&&fcg.mdg.editbp.handlers.ContactPersonChange.oController.changedArray[i].currentEntityKey===c&&(fcg.mdg.editbp.handlers.ContactPersonChange.oController.changedArray[i].entity==="BP_WorkplaceIntAddressVersRel"||fcg.mdg.editbp.handlers.ContactPersonChange.oController.changedArray[i].entity==="BP_WorkplaceIntPersVersionRel")){fcg.mdg.editbp.handlers.ContactPersonChange.oController.changedArray.splice(i,1);i=i-1;}}var k;var m="INP-BP_ContactPersonWorkplacesRel-Addr_Num-"+b;var n=sap.ui.getCore().byId(m).getSelectedKey();for(var l=0;l<fcg.mdg.editbp.handlers.ContactPersonChange.oWPResults.length;l++){if(fcg.mdg.editbp.handlers.ContactPersonChange.oWPResults[l].ADDRESS_NUMBER===n){k=l;break;}}h.addrIndex=k;if(k!==undefined){if(c<fcg.mdg.editbp.handlers.ContactPersonChange.oWPResults[k].BP_WorkplaceIntAddressVersRel.results.length){if(fcg.mdg.editbp.handlers.ContactPersonChange.oWPResults[k].BP_WorkplaceIntAddressVersRel.results[c].action==="N"){fcg.mdg.editbp.handlers.ContactPersonChange.oWPResults[k].BP_WorkplaceIntAddressVersRel.results.splice(c,1);}else{h.entity="BP_WorkplaceIntAddressVersRel";h.currentEntityKey=c;h.wpKey=b;h.action="D";var V=fcg.mdg.editbp.handlers.ContactPersonChange.oWPResults[parseInt(k)].VALIDUNTILDATE;V=fcg.mdg.editbp.util.Formatter.validUntilDateFormat(V);h.currentkey="(BP_GUID="+w.sItemPath+",PARTNER1=\'"+fcg.mdg.editbp.handlers.ContactPersonChange.oWPResults[parseInt(k)].PARTNER1+"\',PARTNER2=\'"+fcg.mdg.editbp.handlers.ContactPersonChange.oWPResults[parseInt(k)].PARTNER2+"\',RELATIONSHIPCATEGORY=\'"+fcg.mdg.editbp.handlers.ContactPersonChange.oWPResults[parseInt(k)].RELATIONSHIPCATEGORY+"\',ADDRESS_NUMBER=\'"+fcg.mdg.editbp.handlers.ContactPersonChange.oWPResults[parseInt(k)].ADDRESS_NUMBER+"\',ADDR_VERS=\'"+fcg.mdg.editbp.util.DataAccess.getDataFromPath(fcg.mdg.editbp.handlers.ContactPersonChange.oWPResults[parseInt(k)],h.entity+"/results/"+c+"/ADDR_VERS")+"\',VALIDUNTILDATE=datetime\'"+escape(V)+"\')";fcg.mdg.editbp.handlers.ContactPersonChange.oController.changedArray.push(h);}}}}var F=a.getFormContainers()[0];var r=F.getFormElements().indexOf(v.getParent());F.getFormElements()[r].destroyFields();F.removeFormElement(F.getFormElements()[r]);if(sap.ui.getCore().byId("toolWPIavAdd-"+b).hasListeners("press")===false){sap.ui.getCore().byId("toolWPIavAdd-"+b).attachPress(fcg.mdg.editbp.handlers.ContactPersonCreate.addNewIAV);sap.ui.getCore().byId("toolWPIavAdd-"+b).removeStyleClass("sapGreyCell");}},addIavToolBar:function(f,w){var t=new sap.m.Title({text:w.i18nBundle.getText("ADDIAV"),level:"H4",titleStyle:"H4",layoutData:new sap.ui.layout.GridData({span:"L4 M4 S6",linebreak:true})});var h=new sap.m.HBox({layoutData:new sap.ui.layout.GridData({span:"L1 M1 S1",indent:"L0 M3 S3",emptySpanL:0})});var i=new sap.ui.core.Icon({src:"sap-icon://sys-add",decorative:false,tooltip:"Add"});i.addStyleClass("sapGreyCell");i.addStyleClass("sapUiSmallMarginEnd");h.addItem(i);var a=new sap.ui.core.Icon({src:"sap-icon://sys-cancel",decorative:false,press:fcg.mdg.editbp.handlers.ContactPersonCreate.removeIavForm,tooltip:"Cancel"});h.addItem(a);f.addContent(t);f.addContent(h);},setvHelpTitle:function(v,f){var w=fcg.mdg.editbp.handlers.ContactPerson.oController;var r=fcg.mdg.editbp.util.DataAccess.getValueHelpData();var d=w.i18nBundle.getText("NONE");var e=new sap.ui.core.Item({key:"",text:d});var t=new sap.ui.model.json.JSONModel();t.setData(r[3].data);var a=new sap.ui.core.Item({key:"{KEY}",text:"{TEXT}"});f.setModel(t);f.bindItems("/results",a);f.addItem(e);f.setSelectedKey("");},setEnabledWPFields:function(w){sap.ui.getCore().byId("INP-BP_ContactPersonWorkplacesRel-Department-"+w).setEnabled(true);sap.ui.getCore().byId("INP-BP_ContactPersonWorkplacesRel-Function-"+w).setEnabled(true);sap.ui.getCore().byId("INP-BP_WorkplaceCommPhonesRel-COUNTRY-0-"+w).setEnabled(true);sap.ui.getCore().byId("INP-BP_WorkplaceCommPhonesRel-TELEPHONE-0-"+w).setEnabled(true);sap.ui.getCore().byId("INP-BP_WorkplaceCommPhonesRel-EXTENSION-0-"+w).setEnabled(true);sap.ui.getCore().byId("INP-BP_WorkplaceCommMobilesRel-COUNTRY-0-"+w).setEnabled(true);sap.ui.getCore().byId("INP-BP_WorkplaceCommMobilesRel-TELEPHONE-0-"+w).setEnabled(true);sap.ui.getCore().byId("INP-BP_WorkplaceCommFaxesRel-COUNTRY-0-"+w).setEnabled(true);sap.ui.getCore().byId("INP-BP_WorkplaceCommFaxesRel-FAX-0-"+w).setEnabled(true);sap.ui.getCore().byId("INP-BP_WorkplaceCommFaxesRel-EXTENSION-0-"+w).setEnabled(true);sap.ui.getCore().byId("INP-BP_WorkplaceCommEMailsRel-E_MAIL-0-"+w).setEnabled(true);var a=["telCPAdd-"+w,"mobCPAdd-"+w,"faxCPAdd-"+w,"emailCPAdd-"+w];var r=["telCPCancel-"+w,"mobCPCancel-"+w,"faxCPCancel-"+w,"emailCPCancel-"+w];var b=[fcg.mdg.editbp.handlers.ContactPersonCreate.addNewTel,fcg.mdg.editbp.handlers.ContactPersonCreate.addNewMob,fcg.mdg.editbp.handlers.ContactPersonCreate.addNewFax,fcg.mdg.editbp.handlers.ContactPersonCreate.addNewEmail];for(var i=0;i<a.length;i++){if(sap.ui.getCore().byId(a[i]).hasListeners("press")===false){sap.ui.getCore().byId(a[i]).attachPress(b[i]);sap.ui.getCore().byId(a[i]).removeStyleClass("sapGreyCell");}if(i===3){break;}if(sap.ui.getCore().byId(r[i]).hasListeners("press")===false){sap.ui.getCore().byId(r[i]).attachPress(fcg.mdg.editbp.handlers.ContactPersonCreate.removeFormElement);sap.ui.getCore().byId(r[i]).removeStyleClass("sapGreyCell");}}var c=fcg.mdg.editbp.handlers.ContactPerson.oController;c.bpHookSetEnabledWPFields(this,w);},setCountryKeyFields:function(w,f,a){var b=[];var c="";if(a.isAddressVisited==="X"&&a.vCurrentActionId==="createRB"){b=fcg.mdg.editbp.handlers.ContactPerson.oController.oDetailComm.BP_AddressesRel.results;}else{b=fcg.mdg.editbp.handlers.ContactPerson.oBPAddrResults.BP_AddressesRel.results;}var d=sap.ui.getCore().byId("INP-BP_ContactPersonWorkplacesRel-Addr_Num-"+w).getSelectedKey();for(var j=0;j<b.length;j++){if(b[j].AD_ID===d){c=b[j].COUNTRY;break;}}if(c===""){var e=fcg.mdg.editbp.handlers.Communication.oCreateModel;for(var k=0;k<e.length;k++){if(e[k].body.AD_ID===d){c=e[k].body.COUNTRY;break;}}}for(var i=0;i<f.length;i++){sap.ui.getCore().byId(f[i]).setValue(c);}},onAddressChange:function(e){var a="";var b=e.getParameters().id;var c=fcg.mdg.editbp.handlers.ContactPerson.oWpAddressResults;var s=sap.ui.getCore().byId(b).getSelectedKey();var d=fcg.mdg.editbp.handlers.ContactPerson.oController;var f=e.getSource().getParent().getParent().getParent().getParent().getId();var g=f.split("-")[1];var h=["INP-BP_WorkplaceCommPhonesRel-COUNTRY-0-"+g,"INP-BP_WorkplaceCommMobilesRel-COUNTRY-0-"+g,"INP-BP_WorkplaceCommFaxesRel-COUNTRY-0-"+g];fcg.mdg.editbp.handlers.ContactPersonCreate.setEnabledWPFields(g);fcg.mdg.editbp.handlers.ContactPersonCreate.setCountryKeyFields(g,h,d);f=sap.ui.getCore().byId(f);fcg.mdg.editbp.handlers.ContactPersonCreate.aWpIds.push(s);for(var i=0;i<c.results.length;i++){if(c.results[i].AD_ID===s){c.results.splice(i,1);}}fcg.mdg.editbp.handlers.ContactPerson.oWpAddressResults=c;if(fcg.mdg.editbp.handlers.ContactPersonChange.oWPModel===""){d.onChange(e);}else{var r=fcg.mdg.editbp.handlers.ContactPerson.oRelResults.BP_RelationsRel.results;var A=[];for(var k=0;k<r.length;k++){if(sap.ui.getCore().byId("SF-BP_Relation-partnerId").getValue()===r[k].PARTNER2){for(var w=0;w<r[k].BP_RelationContactPersonRel.BP_ContactPersonWorkplacesRel.results.length;w++){A.push(r[k].BP_RelationContactPersonRel.BP_ContactPersonWorkplacesRel.results[w].ADDRESS_NUMBER);}if(A.indexOf(s)===-1){d.onChange(e);}}}}sap.ui.getCore().byId(b).setEnabled(false);if(c.results.length>=1&&s!==""){if(sap.ui.getCore().byId("toolWPAdd").hasListeners("press")===false){sap.ui.getCore().byId("toolWPAdd").attachPress(fcg.mdg.editbp.handlers.ContactPersonCreate.addWPAddress);sap.ui.getCore().byId("toolWPAdd").removeStyleClass("sapGreyCell");}}else{if(sap.ui.getCore().byId("toolWPAdd").hasListeners("press")===true){sap.ui.getCore().byId("toolWPAdd").detachEvent("press");sap.ui.getCore().byId("toolWPAdd").detachPress(fcg.mdg.editbp.handlers.ContactPersonCreate.addWPAddress);sap.ui.getCore().byId("toolWPAdd").addStyleClass("sapGreyCell");}}var l=fcg.mdg.editbp.handlers.ContactPerson.oWpIavResults.results;for(var j=0;j<l.length;j++){if(l[j].AD_ID===s){a=j;break;}}var m=fcg.mdg.editbp.handlers.ContactPerson.oWpIavResults.results[a].IAV;if(s!==""&&m!==undefined&&m.length!==0){fcg.mdg.editbp.handlers.ContactPersonCreate.addStaticIavToolBar(f,d);if(sap.ui.getCore().byId("toolWPIavAdd-"+g).hasListeners("press")===false){sap.ui.getCore().byId("toolWPIavAdd-"+g).attachPress(fcg.mdg.editbp.handlers.ContactPersonCreate.addNewIAV);sap.ui.getCore().byId("toolWPIavAdd-"+g).removeStyleClass("sapGreyCell");}if(d.vCurrentActionId==="changeRB"){var L=fcg.mdg.editbp.handlers.ContactPersonCreate;if(fcg.mdg.editbp.handlers.ContactPersonChange.oWPModel!==""){if(fcg.mdg.editbp.handlers.ContactPersonChange.oWPModel.getData().BP_WorkplaceIntAddressVersRel!==undefined){for(var n=0;n<fcg.mdg.editbp.handlers.ContactPersonChange.oWPModel.getData().BP_WorkplaceIntAddressVersRel.results.length;n++){if(fcg.mdg.editbp.handlers.ContactPersonChange.oWPModel.getData().BP_WorkplaceIntAddressVersRel.results[n].action!=="D"){L.oWPIavModel=new sap.ui.model.json.JSONModel();L.oWPIavModel.setData(fcg.mdg.editbp.handlers.ContactPersonChange.oWPModel.getData().BP_WorkplaceIntAddressVersRel.results[n]);L.oExistingIav="X";sap.ui.getCore().byId("toolWPIavAdd-"+g).fireEvent("press");}}}}}}},addIAV:function(){fcg.mdg.editbp.handlers.ContactPersonCreate.oWPIavModel="";fcg.mdg.editbp.handlers.ContactPersonCreate.addNewIAV();},addStaticIavToolBar:function(f,w){var a=f.getId().split("-")[1];var t=new sap.m.Title({text:w.i18nBundle.getText("ADDIAV"),level:"H4",titleStyle:"H4",layoutData:new sap.ui.layout.GridData({span:"L4 M4 S6",linebreak:true})});var h=new sap.m.HBox({layoutData:new sap.ui.layout.GridData({span:"L1 M1 S1",indent:"L0 M3 S3",emptySpanL:0})});var i=new sap.ui.core.Icon({id:"toolWPIavAdd-"+a,decorative:false,src:"sap-icon://sys-add",tooltip:"Add"});i.addStyleClass("sapUiSmallMarginEnd");h.addItem(i);var b=new sap.ui.core.Icon({src:"sap-icon://sys-cancel",decorative:false,tooltip:"Cancel"});b.addStyleClass("sapGreyCell");h.addItem(b);var F=sap.ui.getCore().byId(f.getId()+"--Form").getFormContainers()[0];var e=[];e.push(t,h);var n=new sap.ui.layout.form.FormElement({fields:e});F.insertFormElement(n,F.getFormElements().length);},setEnabledIAVFields:function(a,w,b,c){var s="";if(c.vCurrentActionId==="createRB"){s=fcg.mdg.editbp.handlers.ContactPerson.standardAddress;}else{s=fcg.mdg.editbp.handlers.ContactPersonChange.stdChangeAddress;}var p="";if(s!==""&&s.length>0){var d=s[0].BP_AddressVersionsPersRel.results;for(var i=0;i<d.length;i++){if(d[i].ADDR_VERS===b){p=d[i].BP_AddressPersonVersionRel;}}}if(p!==""){sap.ui.getCore().byId("INP-BP_WorkplaceIntPersVersionRel-TITLE-"+a+"-"+w).setSelectedKey(p.TITLE_P);sap.ui.getCore().byId("INP-BP_WorkplaceIntPersVersionRel-FIRSTNAME-"+a+"-"+w).setValue(p.FIRSTNAME);sap.ui.getCore().byId("INP-BP_WorkplaceIntPersVersionRel-LASTNAME-"+a+"-"+w).setValue(p.LASTNAME);}if(fcg.mdg.editbp.handlers.ContactPerson.vgIsLocked!==true){sap.ui.getCore().byId("INP-BP_WorkplaceIntPersVersionRel-TITLE-"+a+"-"+w).setEnabled(true);sap.ui.getCore().byId("INP-BP_WorkplaceIntPersVersionRel-FIRSTNAME-"+a+"-"+w).setEnabled(true);sap.ui.getCore().byId("INP-BP_WorkplaceIntPersVersionRel-LASTNAME-"+a+"-"+w).setEnabled(true);}sap.ui.getCore().byId("INP-BP_WorkplaceIntAddressVersRel-Department-"+a+"-"+w).setEnabled(true);sap.ui.getCore().byId("INP-BP_WorkplaceIntAddressVersRel-Function-"+a+"-"+w).setEnabled(true);},onIavAddressChange:function(e){var a=e.getParameters().id;var b=fcg.mdg.editbp.handlers.ContactPerson.oWpIavResults;var s=sap.ui.getCore().byId(a).getSelectedKey();var c=fcg.mdg.editbp.handlers.ContactPerson.oController;var f=e.getSource().getParent().getParent().getParent().getParent().getId();f=sap.ui.getCore().byId(f);var d=f.getParent().getParent().getParent().getParent().getParent().getId();d=d.split("-")[1];var g=fcg.mdg.editbp.handlers.ContactPersonCreate.getIAVIndexForIAVForm(e);fcg.mdg.editbp.handlers.ContactPersonCreate.setEnabledIAVFields(a.split("-")[3],a.split("-")[4],s,c);for(var i=0;i<b.results[g].IAV.length;i++){if(b.results[g].IAV[i].ADDR_VERS===s){b.results[g].IAV.splice(i,1);}}fcg.mdg.editbp.handlers.ContactPerson.oWpIavResults=b;var l=fcg.mdg.editbp.handlers.ContactPersonCreate;if(l.oExistingIav===""){c.onChange(e);}else{var r=fcg.mdg.editbp.handlers.ContactPerson.oRelResults.BP_RelationsRel.results;var A=[];for(var k=0;k<r.length;k++){if(sap.ui.getCore().byId("SF-BP_Relation-partnerId").getValue()===r[k].PARTNER2){for(var w=0;w<fcg.mdg.editbp.handlers.ContactPersonChange.oWPModel.getData().BP_WorkplaceIntAddressVersRel.results.length;w++){A.push(fcg.mdg.editbp.handlers.ContactPersonChange.oWPModel.getData().BP_WorkplaceIntAddressVersRel.results[w].ADDR_VERS);}if(A.indexOf(s)===-1){c.onChange(e);}}}}sap.ui.getCore().byId(a).setEnabled(false);if(b.results[g].IAV.length>=1&&s!==""){if(sap.ui.getCore().byId("toolWPIavAdd-"+d).hasListeners("press")===false){sap.ui.getCore().byId("toolWPIavAdd-"+d).attachPress(fcg.mdg.editbp.handlers.ContactPersonCreate.addNewIAV);sap.ui.getCore().byId("toolWPIavAdd-"+d).removeStyleClass("sapGreyCell");}}else{if(sap.ui.getCore().byId("toolWPIavAdd-"+d).hasListeners("press")===true){sap.ui.getCore().byId("toolWPIavAdd-"+d).detachEvent("press");sap.ui.getCore().byId("toolWPIavAdd-"+d).detachPress(fcg.mdg.editbp.handlers.ContactPersonCreate.addNewIAV);sap.ui.getCore().byId("toolWPIavAdd-"+d).addStyleClass("sapGreyCell");}}},getIAVIndex:function(e){var i="",a,b="";var f=e.getSource().getParent().getParent().getParent();var c=f.getFormElements()[1];var d=c.getFields();var g=d[0].getId();if(g.indexOf("INP-BP_WorkplaceIntAddressVersRel-ADDR_VERS")!==-1){var w=g.split("-")[4];a=sap.ui.getCore().byId("INP-BP_ContactPersonWorkplacesRel-Addr_Num-"+w);a=a.getSelectedKey();}else{a=d[0].getSelectedKey();}if(fcg.mdg.editbp.handlers.ContactPerson.oController.isAddressVisited==="X"){b=fcg.mdg.editbp.handlers.ContactPerson.oController.oDetailComm.BP_AddressesRel.results;}else{b=fcg.mdg.editbp.handlers.ContactPerson.oBPAddrResults.BP_AddressesRel.results;}for(var j=0;j<b.length;j++){if(b[j].AD_ID===a){i=j;return i;}}if(i===""){var h=fcg.mdg.editbp.handlers.Communication.oCreateModel;for(var k=0;k<h.length;k++){if(h[k].body.AD_ID===a){i=b.length+k;return i;}}}},getIAVIndexForIAVForm:function(e){var i="",a="";var f=e.getSource().getParent().getParent().getParent().getParent().getParent().getParent().getParent();var b=f.getFormElements()[1];var c=b.getFields();var d=c[0].getSelectedKey();if(fcg.mdg.editbp.handlers.ContactPerson.oController.isAddressVisited==="X"){a=fcg.mdg.editbp.handlers.ContactPerson.oController.oDetailComm.BP_AddressesRel.results;}else{a=fcg.mdg.editbp.handlers.ContactPerson.oBPAddrResults.BP_AddressesRel.results;}for(var j=0;j<a.length;j++){if(a[j].AD_ID===d){i=j;return i;}}if(i===""){var g=fcg.mdg.editbp.handlers.Communication.oCreateModel;for(var k=0;k<g.length;k++){if(g[k].body.AD_ID===d){i=a.length+k;return i;}}}},deleteWorkplaceAddress:function(){var l=fcg.mdg.editbp.handlers.ContactPerson.oController.getView().byId("editLayout");for(var i=2;i<l.getContent().length-1;i++){l.removeContent(l.getContent()[i]);i--;}fcg.mdg.editbp.handlers.ContactPerson.setWPAddressArray(fcg.mdg.editbp.handlers.ContactPerson.oBPAddrResults);fcg.mdg.editbp.handlers.ContactPerson.setWPIavArray(fcg.mdg.editbp.handlers.ContactPerson.oBPAddrResults);var w=fcg.mdg.editbp.handlers.ContactPerson.oController;var c=w.createdArray;for(var j=0;j<c.length;j++){if(c[j].hasOwnProperty("wpKey")){c.splice(j,1);j--;}}if(sap.ui.getCore().byId("toolWPAdd").hasListeners("press")===false){sap.ui.getCore().byId("toolWPAdd").attachPress(fcg.mdg.editbp.handlers.ContactPersonCreate.addWPAddress);sap.ui.getCore().byId("toolWPAdd").removeStyleClass("sapGreyCell");}}};
